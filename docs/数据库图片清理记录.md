# 数据库图片信息清理记录

## 清理时间
2026-01-07

## 清理原因
数据库中存储的图片路径对应的实际文件已丢失，导致前端访问时出现 404 错误。

## 清理操作

### 1. agents 表（代理商头像）
- **字段**: `avatar`
- **清理前**: 6 条记录，1 条有头像
- **清理操作**: `UPDATE agents SET avatar = NULL WHERE avatar IS NOT NULL AND avatar != '';`
- **清理后**: 6 条记录，0 条有头像

### 2. products 表（产品图片）
- **字段**: `image`
- **清理前**: 4 条记录，2 条有图片
- **清理操作**: `UPDATE products SET image = NULL WHERE image IS NOT NULL AND image != '';`
- **清理后**: 4 条记录，0 条有图片

### 3. transactions 表（交易凭证）
- **字段**: `proof`
- **清理前**: 19 条记录，2 条有凭证
- **清理操作**: `UPDATE transactions SET proof = NULL WHERE proof IS NOT NULL AND proof != '';`
- **清理后**: 19 条记录，0 条有凭证

### 4. orders 表（订单图片）
- **字段**: `images` (JSON 数组格式)
- **清理前**: 5 条记录，5 条有图片数组
- **清理操作**: `UPDATE orders SET images = JSON_ARRAY() WHERE images IS NOT NULL;`
- **清理后**: 5 条记录，0 条有图片

## 清理结果

| 表名 | 总记录数 | 清理前有图片 | 清理后有图片 |
|------|---------|------------|------------|
| agents | 6 | 1 | 0 |
| products | 4 | 2 | 0 |
| transactions | 19 | 2 | 0 |
| orders | 5 | 5 | 0 |

## 后续操作建议

1. **重新上传图片**：需要图片的记录可以重新上传
2. **配置备份**：建议配置定期备份上传目录，避免文件丢失
3. **使用云存储**：考虑使用对象存储（OSS/COS）存储上传文件，提高可靠性

## 注意事项

- 所有图片路径已清空，不会影响其他数据
- 前端访问时不会再出现 404 错误（但也不会显示图片）
- 需要图片时，可以重新上传

