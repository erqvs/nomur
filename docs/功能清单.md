# Nomur 微商管理系统 - 功能清单

> **系统地址**：https://nomur.linkmate.site  
> **最后更新**：2024年12月

---

## 目录

- [系统概述](#系统概述)
- [管理端功能](#管理端功能)
- [代理端功能](#代理端功能)
- [公共功能](#公共功能)
- [技术特性](#技术特性)

---

## 系统概述

Nomur 是一个基于 uni-app + Vue3 + TypeScript 的微商代理管理系统，采用双端设计：

- **管理端**：创始人/公司视角，负责商品录入、发货开单、代理管理、财务审核
- **代理端**：代理商视角，查看业绩、余额、任务进度、素材下载

### 核心业务场景

| 场景 | 解决方案 |
|------|----------|
| 代理商订了多少货？ | 订单记录系统 |
| 代理商还欠多少钱？ | 余额管理（支持负数/欠款） |
| 怎么凑满一车发货？ | 整车计算系统 |
| 代理商年度任务完成多少了？ | 业绩追踪（排除赠品） |
| 促销活动送了多少赠品？ | 自动计算搭赠 |
| 代理之间调货怎么结算？ | 原子操作双向记账 |
| 转账截图会不会重复使用？ | 图片查重功能 |

---

## 管理端功能

### 1. 数据驾驶舱（Dashboard）

**页面路径**：`/pages/admin/dashboard/index`

#### 1.1 统计概览
- ✅ 年度总发货箱数统计
- ✅ 近30天出库统计
- ✅ 年度发货分布（按产品）
- ✅ 近30天发货分布（按产品）
- ✅ 产品分布进度条可视化

#### 1.2 代理商列表
- ✅ 代理商头像、姓名、手机号展示
- ✅ 代理商余额显示（支持负数显示，红色标识）
- ✅ 点击跳转代理商详情页
- ✅ 快速跳转商品管理
- ✅ 快速跳转促销管理
- ✅ 切换账号功能

---

### 2. 商品管理

#### 2.1 商品列表（`/pages/admin/products/index`）
- ✅ 商品列表展示（图片、名称、价格、重量、素材数量）
- ✅ 点击商品进入编辑页面
- ✅ 添加商品按钮
- ✅ 空状态提示

#### 2.2 商品编辑（`/pages/admin/products/edit`）
- ✅ 商品图片上传（单张）
  - 图片自动上传到服务器
  - 支持图片预览
- ✅ 商品名称输入
- ✅ 商品价格设置（元/箱）
- ✅ 商品重量设置（kg/箱）
  - 快捷数字选择：1.5, 2, 2.5, 3, 3.5, 4
- ✅ 素材库管理
  - 支持多张图片上传
  - 图片自动上传到服务器
  - 无数量限制
  - 图片预览和删除
- ✅ 创建/编辑商品
- ✅ 删除商品（仅在编辑模式下显示）
  - 删除前二次确认
  - 显示商品名称，提示不可恢复
  - 删除成功后自动返回列表
- ✅ 表单验证

---

### 3. 代理管理

#### 3.1 代理列表（`/pages/admin/agents/index`）
- ✅ 搜索功能（按名称/手机号）
- ✅ 代理商卡片展示
  - 头像
  - 姓名
  - 手机号
  - 余额（负数红色显示）
- ✅ 点击进入代理详情
- ✅ 添加代理按钮

#### 3.2 代理编辑（`/pages/admin/agents/edit`）
- ✅ 代理头像上传
- ✅ 代理姓名输入
- ✅ 主手机号输入
- ✅ 备用手机号输入（可选）
- ✅ 收货地址输入
- ✅ 年度目标设置
  - A产品年度目标（箱）
  - 混合产品年度目标（箱）
- ✅ 创建/编辑代理

#### 3.3 代理详情（`/pages/admin/agents/detail`）
- ✅ 代理基本信息展示
  - 头像、姓名
  - 手机号（可拨打）
  - 收货地址
- ✅ 余额卡片展示
- ✅ 年度目标完成率
  - A产品完成进度（百分比、进度条）
  - 混合产品完成进度（百分比、进度条）
- ✅ 快捷操作
  - 充值
  - 扣款
  - 调货
  - 查看订单
- ✅ 补充销售数据功能
  - 补充数据按钮
  - 选择产品（A产品/混合产品）
  - 输入数量（箱）
  - 选择日期（用于历史数据补录）
  - 备注说明（可选）
  - 确认补充
  - **注意**：仅更新任务完成率统计，不影响代理商余额，不产生订单和交易流水
- ✅ 最近交易记录列表
  - 交易类型图标
  - 交易原因
  - 交易时间
  - 交易金额（正数绿色，负数红色）

---

### 4. 极速开单

**页面路径**：`/pages/admin/orders/index`

#### 4.1 订单创建
- ✅ 选择代理商（标签选择组件）
- ✅ 选择商品（勾选式，支持多选）
  - 商品勾选/取消
  - 数量调整（+/- 按钮、直接输入）
  - 实时计算总数量、总重量、总金额
- ✅ 整车计算
  - 车型选择（支持多车型）
  - 重量进度条可视化
  - 状态提示：
    - 空车（灰色）
    - 重量不足（橙色，提示还差多少）
    - 整车达标（绿色）
    - 超载（红色，禁止提交）
  - 最小/最大重量标记
- ✅ 选择司机（手机号输入）
- ✅ 参与促销（标签选择）
  - 不参与促销
  - 选择活动（显示活动描述）
  - 自动计算赠品数量
- ✅ 订单图片上传（可选，多张）
- ✅ 实时计算结果展示
  - 总数量（箱）
  - 总重量（kg）
  - 总金额（¥）
  - 赠品信息（如有）
- ✅ 代理余额提示
  - 显示当前余额
  - 余额不足警告（红色提示）
- ✅ 确认开单
  - 表单验证
  - 整车重量不足提示（可继续）
  - 超载禁止提交
  - 自动扣款
  - 自动计算并添加赠品

#### 4.2 订单列表（`/pages/admin/orders/list`）
- ✅ 订单列表展示
- ✅ 订单筛选（待发货/已发货/已完成）
- ✅ 订单详情查看

#### 4.3 订单详情（`/pages/admin/orders/detail`）
- ✅ 订单基本信息
  - 订单号
  - 订单状态
  - 代理商名称
  - 创建时间
- ✅ 商品明细列表
  - 商品名称
  - 数量
  - 小计金额
- ✅ 赠品信息展示（如有）
- ✅ 订单汇总
  - 总重量
  - 总金额
  - 司机手机号
  - 备注
- ✅ 订单图片预览
- ✅ 分享订单功能（复制链接）

---

### 5. 财务管理

**页面路径**：`/pages/admin/finance/index`

#### 5.1 快捷操作
- ✅ 充值按钮
- ✅ 扣款按钮
- ✅ 调货按钮

#### 5.2 交易记录
- ✅ 筛选功能（全部/充值/扣款）
- ✅ 交易列表展示
  - 交易图标（根据原因显示不同图标）
  - 代理商名称（可点击查看该代理打款记录）
  - 交易原因标签
  - 收款账户名称（可点击查看该账户收款明细）
  - 交易金额（正数绿色，负数红色）
  - 交易时间
  - 备注信息
  - 凭证图片（可预览）

#### 5.3 充值功能
- ✅ 选择代理商（标签选择）
- ✅ 充值原因选择
  - 代理打款（需选择收款账户）
  - 运费
  - 其他
- ✅ 选择收款账户（仅代理打款时）
- ✅ 备注输入（可选）
- ✅ 充值金额输入
  - 快捷数字：1000, 5000, 10000, 50000
- ✅ 上传凭证（单张）
  - 图片查重（防止重复使用转账截图）
- ✅ 确认充值
  - 自动增加余额
  - 记录交易流水

#### 5.4 扣款功能
- ✅ 选择代理商（标签选择）
- ✅ 扣款原因选择
  - 发货扣款
  - 其他（需输入具体原因）
- ✅ 扣款金额输入
  - 快捷数字：100, 500, 1000, 5000
- ✅ 确认扣款
  - 自动扣除余额
  - 记录交易流水

#### 5.5 调货功能
- ✅ 选择发货方（收款方）
- ✅ 选择收货方（付款方）
- ✅ 选择产品（勾选式）
- ✅ 设置数量（+/- 按钮、直接输入）
- ✅ 优惠金额设置（可选）
- ✅ 实时计算
  - 产品单价
  - 小计
  - 优惠金额
  - 调货总额
- ✅ 确认调货
  - 原子操作：同时完成退款和扣款
  - 发货方余额增加
  - 收货方余额减少
  - 记录两条交易流水（transfer_in / transfer_out）

#### 5.6 客户打款记录查看
- ✅ 点击代理商名称查看该代理的所有打款记录
- ✅ 显示打款时间、金额、收款账户

#### 5.7 收款账户收款明细查看
- ✅ 点击收款账户名称查看该账户的所有收款明细
- ✅ 显示代理商名称、金额、时间
- ✅ 显示总收款金额和笔数

#### 5.8 收款账户管理
- ✅ 收款账户列表
  - 账户名称展示
  - 余额显示（支持负数，红色显示）
  - 点击查看详情
- ✅ 添加收款账户
  - 账户名称输入（必填）
  - 账号输入（可选）
  - 开户银行输入（可选）
  - 收款二维码上传（可选）
    - 图片自动上传到服务器
    - 支持预览和删除
  - 表单验证
  - 添加成功后自动刷新列表
- ✅ 收款账户详情页
  - 账户基本信息（名称、账号、银行）
  - 余额卡片展示
  - 余额明细列表
    - 交易类型（收款/扣费）
    - 交易原因
    - 交易金额（正数绿色，负数红色）
    - 交易时间
    - 关联代理商（如有）
    - 备注信息
  - 筛选功能（全部/收款/扣费）
- ✅ 收款账户扣费功能
  - 选择收款账户（标签选择）
  - 扣费原因选择
    - 提现
    - 手续费
    - 其他（需输入具体原因）
  - 扣费金额输入
    - 快捷数字：100, 500, 1000, 5000
  - 备注输入（可选）
  - 确认扣费
    - 自动扣除余额
    - 记录交易流水

---

### 6. 促销管理

**页面路径**：`/pages/admin/promotions/index`

#### 6.1 促销列表
- ✅ 促销活动卡片展示
  - 活动状态（进行中/已结束）
  - 活动名称
  - 活动描述
  - 活动规则（每满X件赠送）
  - 赠品列表
  - 活动时间
- ✅ 启用/停用促销
- ✅ 删除促销

#### 6.2 添加促销活动
- ✅ 活动名称输入
- ✅ 活动说明输入
- ✅ 满足条件设置（件数）
- ✅ 赠品选择（多选）
  - 产品列表展示
  - 勾选式选择
  - 设置每个赠品的数量
- ✅ 开始日期选择
- ✅ 结束日期选择
- ✅ 确认添加

---

## 代理端功能

### 1. 业绩看板（首页）

**页面路径**：`/pages/agent/home/index`

#### 1.1 个人信息
- ✅ 代理头像、姓名、手机号展示
- ✅ 切换身份按钮

#### 1.2 余额卡片
- ✅ 当前余额显示（支持负数，红色显示）
- ✅ 点击查看余额明细

#### 1.3 年度任务进度
- ✅ A产品任务进度
  - 已完成/目标（箱）
  - 完成百分比
  - 进度条可视化
  - 环形进度图
- ✅ 混合产品（B+C+D）任务进度
  - 已完成/目标（箱）
  - 完成百分比
  - 进度条可视化
  - 环形进度图

#### 1.4 促销活动进度
- ✅ 进行中的促销活动展示
  - 活动名称
  - 活动规则
  - 已购买数量
  - 已获赠品列表
  - 进度条（当前进度/满额）
  - 距下次赠品还差多少件

#### 1.5 快捷入口
- ✅ 余额明细
- ✅ 促销查询
- ✅ 我的订单
- ✅ 素材下载

#### 1.6 最近订单
- ✅ 最近5条订单展示
  - 订单号
  - 订单状态
  - 商品列表
  - 订单时间
  - 订单金额

---

### 2. 余额明细

**页面路径**：`/pages/agent/balance/index`

#### 2.1 余额卡片
- ✅ 当前余额显示
- ✅ 余额标签

#### 2.2 交易记录
- ✅ 筛选功能（全部/收入/支出）
- ✅ 交易列表
  - 交易图标
  - 交易原因
  - 交易时间
  - 订单明细（如有）
  - 备注信息
  - 交易金额（正数绿色，负数红色）

---

### 3. 促销查询

**页面路径**：`/pages/agent/promotions/index`

#### 3.1 进行中的促销
- ✅ 促销活动卡片
  - 活动名称
  - 活动时间
  - 活动规则
  - 赠品列表
- ✅ 我的进度
  - 已购买数量（件）
  - 已获赠品数量（件）
  - 距下次赠品还差多少（件）
  - 进度条可视化
  - 鼓励提示

#### 3.2 历史促销
- ✅ 已结束的促销活动列表
  - 活动名称
  - 活动时间
  - 已结束标签

---

### 4. 我的订单

**页面路径**：`/pages/agent/orders/index`

#### 4.1 订单筛选
- ✅ 全部订单
- ✅ 待发货（显示数量红点）
- ✅ 已发货（显示数量红点）
- ✅ 已完成

#### 4.2 订单列表
- ✅ 订单卡片展示
  - 订单号
  - 订单状态
  - 商品明细（名称、数量、小计）
  - 总重量
  - 总金额
  - 订单时间
  - 司机手机号
  - 赠品信息（如有）
- ✅ 分享订单功能
- ✅ 空状态提示

---

### 5. 素材下载

**页面路径**：`/pages/agent/materials/index`

#### 5.1 产品选择
- ✅ 产品标签切换
- ✅ 当前产品高亮

#### 5.2 素材列表
- ✅ 素材数量统计
- ✅ 素材网格展示（3列）
- ✅ 图片预览（点击）
- ✅ 保存单张图片（长按或按钮）
- ✅ 保存全部素材按钮

#### 5.3 网盘链接
- ✅ 高清大图/视频素材链接
- ✅ 点击跳转百度网盘（H5）或复制链接（小程序）

---

### 6. 个人中心

**页面路径**：`/pages/agent/profile/index`

#### 6.1 个人信息
- ✅ 头像、姓名、手机号展示

#### 6.2 余额卡片
- ✅ 账户余额显示
- ✅ 点击查看余额明细

#### 6.3 功能菜单
- ✅ 我的订单
- ✅ 余额明细
- ✅ 促销活动
- ✅ 素材下载

#### 6.4 收货地址
- ✅ 地址信息展示

#### 6.5 年度目标
- ✅ A产品目标（箱）
- ✅ 混合产品目标（箱）

#### 6.6 切换账号
- ✅ 返回角色选择页面

---

## 公共功能

### 1. 角色选择

**页面路径**：`/pages/index/index`

- ✅ 系统Logo展示
- ✅ 应用名称和描述
- ✅ 管理端入口
  - 描述：创始人/公司 - 商品录入、发货开单、代理管理、财务审核
- ✅ 代理端入口
  - 描述：代理商 - 查看业绩、余额明细、任务进度、素材下载
  - 选择后弹出代理商列表
  - 选择代理商进入对应代理端

---

### 2. 公共组件

#### 2.1 TagSelect（标签选择组件）
- ✅ 单选模式
- ✅ 多选模式
- ✅ 标签显示（主标签、副标签）
- ✅ 紧凑模式
- ✅ 选中状态视觉反馈

#### 2.2 ImageUploader（图片上传组件）
- ✅ 多图上传
- ✅ 无数量限制
- ✅ 图片预览
- ✅ 删除图片
- ✅ 上传进度提示
- ✅ 自定义提示文字

#### 2.3 QuickInput（快捷输入组件）
- ✅ 文本输入
- ✅ 数字输入
- ✅ 前缀/后缀显示
- ✅ 快捷数字选择
- ✅ 必填标识
- ✅ 占位符提示

#### 2.4 BalanceCard（余额卡片组件）
- ✅ 余额显示（支持负数，红色显示）
- ✅ 标签文字
- ✅ 副信息显示
- ✅ 点击事件

---

### 3. 后端API功能

#### 3.1 认证API
- ✅ 手机号验证权限
- ✅ 微信小程序手机号授权
- ✅ 管理员管理（增删查）

#### 3.2 商品API
- ✅ 获取所有商品
- ✅ 创建商品
- ✅ 更新商品
- ✅ 删除商品

#### 3.3 代理商API
- ✅ 获取所有代理商
- ✅ 获取单个代理商
- ✅ 创建代理商
- ✅ 更新代理商

#### 3.4 订单API
- ✅ 获取订单列表（支持按代理商筛选）
- ✅ 获取单个订单
- ✅ 创建订单（含自动扣款）
- ✅ 更新订单状态

#### 3.5 交易流水API
- ✅ 获取交易流水（支持按代理商筛选）
- ✅ 充值（含图片查重）
- ✅ 扣款
- ✅ 调货（原子操作）

#### 3.6 促销活动API
- ✅ 获取所有促销活动
- ✅ 创建促销活动

#### 3.7 车型管理API
- ✅ 获取所有车型
- ✅ 创建车型
- ✅ 更新车型
- ✅ 删除车型

#### 3.8 收款账户API
- ✅ 获取所有收款账户
- ✅ 创建收款账户
- ✅ 更新收款账户（含余额设置）
- ✅ 获取收款账户的收款明细
- ✅ 获取收款账户余额明细（含收款和扣费）
- ✅ 收款账户扣费

#### 3.9 图片查重API
- ✅ 检查图片是否重复
- ✅ 记录已上传图片

#### 3.10 统计API
- ✅ 全局统计（年度/近30天发货统计）
- ✅ 代理商统计（年度任务完成率，排除赠品）

#### 3.11 数据补充API
- ✅ 补充销售数据（仅更新任务完成率，不影响余额）
- ✅ 获取补充数据记录
- ✅ 删除补充数据记录（可选）

---

## 技术特性

### 1. 交互体验
- ✅ 禁止使用下拉菜单，全部使用勾选式交互
- ✅ 大按钮、大触控区域（最小44px）
- ✅ 实时计算（毫秒级响应）
- ✅ 震动反馈（选中时）
- ✅ 图片上传无数量限制

### 2. 数据安全
- ✅ 调货原子操作（事务保证）
- ✅ 图片查重（防止重复使用转账截图）
- ✅ 余额支持负数（欠款状态）

### 3. 业务逻辑
- ✅ 促销活动自动计算赠品
- ✅ 整车计算（重量范围检查）
- ✅ 年度任务统计（排除赠品）
- ✅ 调货扣除完成量

### 4. 移动端优化
- ✅ 单手操作友好
- ✅ 减少输入，多用选择
- ✅ 关键操作不超过3步
- ✅ 图片预览和保存

### 5. 视觉规范
- ✅ 主色：#1890FF（科技蓝）
- ✅ 成功：#52C41A
- ✅ 警告：#FAAD14
- ✅ 危险：#FF4D4F
- ✅ 卡片圆角：12rpx
- ✅ 统一阴影效果

---

## 功能统计

### 管理端功能模块
- 数据驾驶舱：7个功能点
- 商品管理：9个功能点（新增：删除商品功能）
- 代理管理：20个功能点（新增：补充销售数据功能）
- 极速开单：20个功能点
- 财务管理：38个功能点（新增：收款账户管理、添加收款账户）
- 促销管理：8个功能点

**管理端总计：102个功能点**（+4）

### 代理端功能模块
- 业绩看板：15个功能点
- 余额明细：5个功能点
- 促销查询：8个功能点
- 我的订单：8个功能点
- 素材下载：8个功能点
- 个人中心：10个功能点

**代理端总计：54个功能点**

### 公共功能
- 角色选择：3个功能点
- 公共组件：15个功能点
- 后端API：35个功能点（新增：数据补充API、收款账户余额API）

**公共功能总计：53个功能点**

---

## 总计

**全系统功能点：209个**（+4）

### 最新新增功能点统计
- 商品管理：+1个功能点（删除商品）
- 财务管理：+3个功能点（添加收款账户）
- 图片上传：全部图片上传功能升级为服务器端上传（商品图片、素材库、头像、订单照片、凭证、二维码等）

**本次新增：4个功能点**

### 历史新增功能点统计
- 代理管理：+5个功能点（补充销售数据）
- 财务管理：+10个功能点（收款账户余额管理）
- 后端API：+5个功能点（数据补充API、收款账户余额API）

**累计新增：24个功能点**

---

## 更新日志

### 2024-12-21（最新）
- ✅ 新增：删除商品功能（商品管理模块）
  - 在商品编辑页面支持删除商品
  - 删除前二次确认，防止误操作
  - 删除成功后自动返回列表
- ✅ 新增：添加收款账户功能（财务管理模块）
  - 支持创建新的收款账户
  - 支持设置账户名称、账号、开户银行、收款二维码
  - 图片自动上传到服务器
- ✅ 升级：图片上传功能全面升级
  - 所有图片上传改为服务器端上传
  - 图片保存为永久URL（不再是blob URL）
  - 支持商品图片、素材库、头像、订单照片、凭证、二维码等
- 功能点总数：205 → 209（+4）

### 2024-12-20
- ✅ 新增：任务完成率数据补充功能（代理管理模块）
  - 支持手动补充销售数据，不影响代理商余额
  - 用于补录历史数据或修正统计
- ✅ 新增：收款账户余额管理功能（财务管理模块）
  - 收款账户余额字段和显示
  - 收款账户余额明细查看
  - 收款账户扣费功能
- 功能点总数：185 → 205（+20）

### 2024-12-20（初始）
- 初始版本功能清单完成
- 涵盖所有管理端和代理端功能
- 包含所有API接口和组件功能

---

*本文档会随着系统更新持续维护*

