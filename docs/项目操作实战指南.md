# Nomur 微商管理系统 - 实战操作指南

> **目的**：通过实际操作用户故事，帮你快速熟悉项目并发现潜在bug  
> **建议**：按照这个文档的顺序操作，每个步骤都仔细测试

---

## 开场：假设你是一家食品批发公司的创始人

你刚刚上线了这套微商管理系统，需要管理50多个代理商。今天是系统上线的第一天，你需要完成初始化设置，然后处理第一笔业务。

**重要说明**：这个指南包含了完整的数据恢复步骤。由于数据库已经被清空，你需要按照这个指南的步骤，手动在系统中添加以下数据：

- **4个商品**：芒果果汁、金桂茶、茉莉茶、龙井茶
- **5个代理商**：张三、李四、王五、赵六、啊
- **3个收款账户**：公司对公账户、张总微信、张总支付宝
- **2个促销活动**：芒果果汁促销、茶类产品促销
- **3个订单**：张三、李四、王五的订单
- **交易记录**：充值、扣款等记录

通过这些具体的操作步骤，你既能熟悉系统功能，又能测试系统的正确性，并发现潜在的bug。

---

## 第一章：系统初始化 - 搭建你的业务基础

### 第一步：登录系统，进入管理端

打开浏览器，访问 `https://nomur.linkmate.site`，你会看到首页有两个选择：**管理端** 和 **代理端**。作为公司创始人，你点击**管理端**。

**✅ 检查点**：页面是否能正常加载？点击管理端是否有响应？是否有错误提示？

进入管理端后，你看到了**数据驾驶舱**。这时候还是空的，因为还没有数据。右上角有三个按钮：商品、促销、切换账号。

### 第二步：添加商品（4个商品）

你的公司主要销售茶类和果汁产品。现在你要在系统中添加4个商品。点击右上角的**商品**按钮，进入商品管理页面。目前是空的，你点击右下角的**添加商品**按钮。

#### 商品1：芒果果汁

现在你要添加第一个商品："芒果果汁"。你需要：

1. **上传商品图片**：点击图片上传区域，选择一张果汁的图片
   - **观察点**：图片是否能正常上传？上传后是否显示预览？
   - **Bug检查**：试试上传很大的图片（比如10MB），会不会卡死？试试上传非图片文件（如PDF），系统如何处理？

2. **输入商品名称**：在"商品名称"输入框中输入`芒果果汁`
   - **观察点**：输入框是否正常？能否正常输入中文？
   - **Bug检查**：这是之前我们修复的输入框bug！试试第一次输入时是否会立即清空？如果会，说明修复还没生效。试试输入很长的名称（100个字符），界面会不会变形？

3. **设置价格**：在"商品价格"输入框输入`299`，表示299元/箱
   - **观察点**：价格输入是否正常？
   - **Bug检查**：试试输入负数（如-100），系统是否允许？试试输入小数（如299.5），是否正确保存？

4. **设置重量**：点击快捷数字按钮选择`2.5`，表示每箱2.5kg
   - **观察点**：快捷按钮点击是否有效？
   - **Bug检查**：如果不点快捷按钮，手动输入重量是否可以？输入0或负数会怎样？

5. **上传素材库**：在素材库区域点击"添加素材"，上传2-3张商品宣传图片
   - **观察点**：多图上传是否正常？图片会自动上传到服务器（显示上传进度）
   - **Bug检查**：图片会自动上传到服务器（不再是blob URL），上传成功后显示服务器URL
   - **Bug检查**：试试一次性上传10张图片，会不会卡顿？上传进度是否显示正确？
   - **Bug检查**：上传后删除某张图片，是否正常？

6. **保存商品**：点击底部的"添加商品"按钮
   - **观察点**：保存是否成功？是否跳转到商品列表？
   - **Bug检查**：如果必填项不填（比如不填名称），是否有错误提示？提示是否清晰？

**保存成功后**，你会在商品列表看到刚才添加的商品。点击这个商品卡片，可以再次进入编辑页面。试试修改价格和重量，保存后检查是否正确更新。

**测试删除商品功能**（编辑模式下）：
- 在商品编辑页面，底部会显示两个按钮：红色的"删除商品"和绿色的"保存修改"
- 点击"删除商品"按钮，会弹出确认对话框，提示"确定要删除商品"XXX"吗？删除后无法恢复。"
- 点击"删除"确认后，商品会被删除并返回商品列表
- **Bug检查**：删除商品后，如果该商品已被订单使用，系统是否会报错？订单详情中该商品信息是否会丢失？

#### 商品2：金桂茶

继续添加第二个商品："金桂茶"。

1. 点击"添加商品"
2. 上传商品图片
3. 商品名称：`金桂茶`
4. 商品价格：`399` 元/箱
5. 商品重量：点击快捷按钮选择 `3` kg/箱
6. 素材库：上传2-3张素材图片
7. 保存

#### 商品3：茉莉茶

添加第三个商品："茉莉茶"。

1. 点击"添加商品"
2. 上传商品图片
3. 商品名称：`茉莉茶`
4. 商品价格：`499` 元/箱
5. 商品重量：点击快捷按钮选择 `3.5` kg/箱
6. 素材库：上传素材图片
7. 保存

#### 商品4：龙井茶

添加第四个商品："龙井茶"。

1. 点击"添加商品"
2. 上传商品图片
3. 商品名称：`龙井茶`
4. 商品价格：`599` 元/箱
5. 商品重量：点击快捷按钮选择 `4` kg/箱
6. 素材库：上传素材图片
7. 保存

**额外测试**：
- 添加一个名称完全相同的商品，系统是否允许？
- 尝试删除一个商品（如果功能存在），删除后相关订单是否会出问题？
- 商品列表如果有很多商品（比如20个），滚动是否流畅？

### 第三步：添加收款账户（3个账户）

返回数据驾驶舱（点击底部导航的第一个图标），点击底部导航的**财务**标签，进入财务管理页面。

点击右上角的**收款账户**按钮，进入收款账户管理弹窗。

现在界面已经支持**添加收款账户**功能了！在收款账户管理弹窗底部，你会看到一个**"添加收款账户"**按钮。

#### 收款账户1：公司对公账户

点击"添加收款账户"按钮，弹出添加表单：

1. **账户名称**：输入`公司对公账户`（必填）
   - **Bug检查**：不填写账户名称，是否有错误提示？

2. **账号**（可选）：输入`6222021234567890123`
   - **观察点**：可选字段是否真的可选？

3. **开户银行**（可选）：输入`中国工商银行`
   - **观察点**：可选字段是否真的可选？

4. **收款二维码**（可选）：点击"点击上传二维码"，上传一张收款码图片
   - **观察点**：图片上传是否正常？上传后是否显示预览？
   - **Bug检查**：上传图片后，点击删除按钮（×），是否能删除？

5. **保存**：点击"确认添加"按钮
   - **观察点**：保存成功后是否自动刷新列表？
   - **观察点**：新添加的账户是否显示在列表中？余额是否正确（应该是0）？

#### 收款账户2：张总微信

继续添加第二个收款账户：

1. 点击"添加收款账户"
2. 账户名称：`张总微信`
3. 账号：留空
4. 开户银行：留空
5. 收款二维码：上传微信收款码图片（可选）
6. 保存

#### 收款账户3：张总支付宝

添加第三个收款账户：

1. 点击"添加收款账户"
2. 账户名称：`张总支付宝`
3. 账号：留空
4. 开户银行：留空
5. 收款二维码：上传支付宝收款码图片（可选）
6. 保存

**验证收款账户功能**：
- 添加完成后，列表中应该能看到3个收款账户
- 每个账户都显示名称和余额（初始为0）
- 点击账户卡片，可以查看账户详情（余额明细、交易记录等）
- **Bug检查**：如果收款账户列表是空的，后续充值选择收款账户时，系统是否有提示？会不会导致无法继续操作？
- **Bug检查**：收款账户详情页中的余额计算是否正确？

### 第四步：添加代理商（5个代理商）

现在你要添加你的代理商。返回数据驾驶舱（点击底部导航的第一个图标），点击底部导航的**客户**标签，进入代理管理页面。

#### 代理商1：张三

点击右下角的**添加代理**按钮，开始添加第一个代理商：

1. **上传头像**：点击头像区域，选择一张照片（或留空，会显示默认头像）
   - **观察点**：图片会自动上传到服务器（不再是blob URL），上传成功后显示服务器URL
   - **Bug检查**：如果不传头像，是否会显示默认头像？默认头像路径是否正确？（使用的是default-avatar.svg）
   - **Bug检查**：上传头像后，头像URL是否是服务器URL？刷新页面后头像是否仍然显示？

2. **输入姓名**：输入`张三`
   - **Bug检查**：这是之前我们修复的输入框bug！试试第一次输入时是否会立即清空？如果会，说明修复还没生效。

3. **输入主手机号**：输入`13800138001`
   - **Bug检查**：输入非11位数字会怎样？输入字母会怎样？验证逻辑是否正确？

4. **输入备用手机号**（可选）：输入`13900139001`
   - **观察点**：可选字段是否真的可选？不填写是否影响保存？

5. **输入地址**：输入`北京市朝阳区建国路88号`
   - **Bug检查**：地址是否支持换行？如果地址很长（比如200字），显示是否正常？

6. **设置年度目标**：
   - A产品目标：输入`500`（箱/年）
   - 混合产品目标：输入`300`（箱/年）
   - **Bug检查**：目标设置为0会怎样？设置为负数会怎样？设置为非常大的数字（如999999）会怎样？

7. **保存**：点击"添加代理"
   - **观察点**：保存成功后是否返回代理列表？列表中是否显示新添加的代理？

**为张三充值**（稍后在财务管理部分会详细说明）：
- 进入张三的详情页，点击"充值"
- 选择充值原因：代理打款
- 选择收款账户：公司对公账户（或任意一个已创建的账户）
- 金额：`50000`
- 上传凭证（可以上传任意图片作为测试）
- 备注：`初始充值`
- 确认充值

**补充销售数据**（在代理详情页）：
- 点击"补充数据"按钮
- 产品类型：A产品
- 数量：`10`
- 日期：选择 `2024-12-20`
- 备注：`测试`
- 确认补充

#### 代理商2：李四

继续添加第二个代理商："李四"。

1. 点击"添加代理"
2. 上传头像（可选）
3. 姓名：`李四`
4. 手机号：`13800138002`
5. 备用手机号：留空
6. 地址：`上海市浦东新区陆家嘴环路1000号`
7. A产品目标：`400` 箱/年
8. 混合产品目标：`250` 箱/年
9. 保存

**为李四充值并调整余额**（稍后在财务管理部分详细说明）：
- 充值30000元（代理打款）
- 然后通过"扣款"功能，直接扣款31500元
- 余额会变成-1500元（欠款状态，这样你就能测试负数余额的功能）

#### 代理商3：王五

添加第三个代理商："王五"。

1. 点击"添加代理"
2. 上传头像（可选）
3. 姓名：`王五`
4. 手机号：`13800138003`
5. 备用手机号：留空
6. 地址：`广州市天河区珠江新城花城大道`
7. A产品目标：`600` 箱/年
8. 混合产品目标：`400` 箱/年
9. 保存

**为王五充值**：
- 点击"充值"
- 充值原因：如果有"其他"选项，选择它（对应gift类型），否则选择"代理打款"
- 金额：`5000`
- 备注：`赠送`
- 确认充值

**注意**：如果系统界面没有"其他"选项，可能需要先充值为"代理打款"，后续通过其他方式调整。

#### 代理商4：赵六

添加第四个代理商："赵六"。

1. 点击"添加代理"
2. 上传头像（可选）
3. 姓名：`赵六`
4. 手机号：`13800138004`
5. 备用手机号：`13900139004`
6. 地址：`深圳市南山区科技园南区`
7. A产品目标：`350` 箱/年
8. 混合产品目标：`200` 箱/年
9. 保存

**为赵六充值**：
- 充值8200元（代理打款）

#### 代理商5：啊

添加第五个代理商："啊"（这个代理商用于测试特殊字符）。

1. 点击"添加代理"
2. 上传头像（可选）
3. 姓名：`啊`
4. 手机号：`13288888888`
5. 备用手机号：留空
6. 地址：`浙江省`
7. A产品目标：`1000` 箱/年
8. 混合产品目标：`500` 箱/年
9. 保存

**注意**：这个代理余额为0，不需要充值。你可以用它来测试余额为0时的各种操作。

### 第五步：测试代理列表功能

在代理列表页面：

1. **搜索功能**：在顶部搜索框输入"张"，看看是否能筛选出"张三"
   - **Bug检查**：搜索手机号是否也能搜索到？搜索不存在的关键词，是否会显示空状态？

2. **查看代理详情**：点击"张三"的卡片，进入详情页
   - **观察点**：信息是否都正确显示？
   - **观察点**：余额显示是否正确？应该是50000元
   - **观察点**：李四的余额应该显示-1500元（负数，红色显示）

3. **编辑代理信息**：如果有编辑按钮，试试修改姓名和手机号，保存后检查是否更新

### 第六步：创建促销活动（2个）

返回数据驾驶舱，点击右上角的**促销**按钮，进入促销管理页面。

**注意**：促销活动的创建功能需要确认系统界面是否支持。如果界面不支持，可能需要通过API创建，或者暂时跳过这一步。

#### 促销活动1：芒果果汁促销

1. 点击"添加促销"（如果界面有）
2. 活动名称：`芒果果汁促销`
3. 活动描述：`芒果果汁买100箱送8箱随机茶`
4. 门槛数量：`100` 箱
5. 赠品设置：
   - 选择赠品商品：`金桂茶`
   - 赠品数量：`8` 箱
6. 活动开始日期：`2024-12-01`
7. 活动结束日期：`2025-12-31`
8. 保存

#### 促销活动2：茶类产品促销

1. 点击"添加促销"
2. 活动名称：`茶类产品促销`
3. 活动描述：`茶类产品买100箱送6箱随机茶`
4. 门槛数量：`100` 箱
5. 赠品设置：
   - 选择赠品商品：`金桂茶`
   - 赠品数量：`6` 箱
6. 活动开始日期：`2024-12-01`
7. 活动结束日期：`2025-12-31`
8. 保存

**Bug检查**：促销活动创建后，在创建订单时是否会自动应用？赠品计算是否正确？

---

## 第二章：处理业务 - 代理商充值和订单创建

### 第一步：明确目标余额

在开始充值和创建订单之前，我们需要明确每个代理商的**目标余额**（即最终希望达到的余额）：

- **张三**：目标余额 15000元
- **李四**：目标余额 -1500元（欠款状态，用于测试负数余额）
- **王五**：目标余额 28500元
- **赵六**：目标余额 8200元（保持不变）
- **啊**：目标余额 0元（保持不变）

**重要说明**：创建订单时会自动从代理商余额中扣款，所以我们需要**先计算好充值金额**，确保创建订单后余额达到目标值。

---

### 第二步：为代理商充值

#### 充值前准备：计算充值金额

根据目标余额和订单金额，计算每个代理商需要充值的金额：

1. **张三**：
   - 目标余额：15000元
   - 订单金额：26920元（后续会创建）
   - **需要充值**：15000 + 26920 = **41920元**

2. **李四**：
   - 目标余额：-1500元
   - 订单金额：29900元（后续会创建）
   - **需要充值**：-1500 + 29900 = **28400元**
   - **注意**：由于李四最终余额是负数，我们也可以先充值30000元，创建订单后余额变成100元，再通过扣款调整到-1500元

3. **王五**：
   - 目标余额：28500元
   - 订单金额：31940元（后续会创建）
   - **需要充值**：28500 + 31940 = **60440元**

4. **赵六**：
   - 目标余额：8200元
   - 无订单
   - **需要充值**：**8200元**

#### 操作流程：为张三充值

进入**财务管理**页面（或从代理详情页进入），点击**充值**按钮，弹出充值弹窗：

1. **选择代理商**：在代理商选择区域，你应该能看到"张三"的选项，点击选择
   - **观察点**：代理商的余额是否正确显示在选项下方？（应该显示0元）
   - **Bug检查**：如果有很多代理商（比如50个），选择列表是否能正常滚动？

2. **选择充值原因**：点击"代理打款"选项（默认已选中）
   - **观察点**：选择后是否有视觉反馈？

3. **选择收款账户**：因为选择了"代理打款"，会显示"选择收款账户"选项
   - 选择"公司对公账户"（或之前创建的任意收款账户）
   - **Bug检查**：如果收款账户列表是空的，是否有提示？会不会导致无法继续操作？

4. **输入金额**：输入`41920`
   - **观察点**：快捷数字按钮（1000, 5000, 10000等）是否可用？点击后金额是否正确填入？
   - **提示**：如果快捷按钮没有41920，可以点击40000，再手动输入1920

5. **上传凭证**：点击"上传凭证"，上传一张转账截图（可以上传任意图片作为测试）
   - **观察点**：图片会自动上传到服务器（不再是blob URL），上传成功后显示服务器URL
   - **Bug检查**：上传图片后是否显示预览？如果上传了之前用过的图片（图片查重功能），是否有提示？
   - **Bug检查**：如果不传凭证，系统是否允许保存？（根据业务规则，代理打款应该必须上传凭证）
   - **Bug检查**：上传的凭证图片URL是否是服务器URL？刷新页面后图片是否仍然显示？

6. **填写备注**（可选）：输入`初始充值`
   - **观察点**：备注是否可选？不填写是否影响保存？

7. **确认充值**：点击"确认充值"按钮
   - **观察点**：是否有加载提示？保存成功后是否有成功提示？
   - **观察点**：保存成功后，弹窗是否关闭？返回列表后，是否能看到新的交易记录？

**验证张三充值结果**：

1. **查看交易记录**：在财务管理页面，应该能看到一条新的充值记录
   - **观察点**：记录是否显示正确的代理商名称（张三）、金额（41920元）、时间？
   - **观察点**：点击记录中的"张三"，是否能查看他的所有交易记录？
   - **观察点**：点击"收款人：公司对公账户"，是否能查看该收款账户的收款明细？

2. **查看代理商余额**：
   - 进入张三的详情页，查看余额卡片，应该显示**41920元**
   - **Bug检查**：余额计算是否正确？

3. **查看收款账户余额**：
   - 进入收款账户详情，查看余额，应该增加了41920元
   - **Bug检查**：收款账户余额计算是否正确？

#### 为李四充值

按照同样的流程，为李四充值：

1. **选择代理商**：选择"李四"
2. **选择充值原因**：代理打款
3. **选择收款账户**：公司对公账户
4. **输入金额**：输入`28400`
5. **上传凭证**：上传转账截图
6. **填写备注**（可选）：`初始充值`
7. **确认充值**

**验证李四充值结果**：
- 进入李四详情页，余额应该显示**28400元**
- 检查交易记录是否正确

#### 为王五充值

按照同样的流程，为王五充值：

1. **选择代理商**：选择"王五"
2. **选择充值原因**：如果有"其他"选项，选择它（对应gift类型），否则选择"代理打款"
3. **选择收款账户**：如果是"代理打款"，选择"公司对公账户"；如果是"其他"类型，可能不需要选择收款账户
4. **输入金额**：输入`60440`
5. **上传凭证**：如果是"代理打款"，需要上传凭证；如果是"其他"类型，可能不需要
6. **填写备注**（可选）：`初始充值`
7. **确认充值**

**验证王五充值结果**：
- 进入王五详情页，余额应该显示**60440元**
- 检查交易记录是否正确

#### 为赵六充值

按照同样的流程，为赵六充值：

1. **选择代理商**：选择"赵六"
2. **选择充值原因**：代理打款
3. **选择收款账户**：公司对公账户
4. **输入金额**：输入`8200`
5. **上传凭证**：上传转账截图
6. **确认充值**

**验证赵六充值结果**：
- 进入赵六详情页，余额应该显示**8200元**
- 检查交易记录是否正确

#### 验证所有充值结果

充值完成后，做以下验证：

1. **查看所有代理商余额**：
   - 张三：应该是**41920元**
   - 李四：应该是**28400元**
   - 王五：应该是**60440元**
   - 赵六：应该是**8200元**
   - **Bug检查**：所有余额计算是否正确？

2. **查看交易记录**：
   - 在财务管理页面，应该能看到所有充值记录
   - **Bug检查**：记录是否正确？能否按代理商筛选？

3. **查看收款账户余额**：
   - 如果所有充值都选择了同一个收款账户，该账户余额应该是 41920 + 28400 + 60440 + 8200 = **138960元**
   - **Bug检查**：收款账户余额计算是否正确？

---

### 第三步：创建订单

现在开始创建订单。**重要提醒**：创建订单时会自动从代理商余额中扣款，所以创建订单后，余额会发生变化。

#### 订单1：张三的订单（目标：创建后余额为15000元）

进入**极速开单**页面（底部导航的"开单"标签），开始创建第一个订单：

1. **选择代理商**：在顶部选择代理商区域，点击"张三"
   - **观察点**：是否显示张三的余额信息？（应该是41920元）
   - **Bug检查**：余额显示是否正确？

2. **选择商品和数量**：
   
   a. **选择芒果果汁**：点击"芒果果汁"的商品卡片，卡片应该被选中（有勾选标记）
   - **观察点**：选中后是否有视觉反馈？
   - **Bug检查**：如果快速连续点击，会不会重复选中/取消？

   b. **设置数量**：选中后，右侧会显示数量输入框。点击"+"按钮，或直接输入`50`
   - **观察点**：数量输入框是否正常？能否直接输入数字？
   - **Bug检查**：这是之前修复的input事件bug！试试在数量框中直接输入数字，第一次输入时是否会被清空？

   c. **选择金桂茶**：点击商品卡片，选中后设置数量为`30`
   - **观察点**：多选商品是否正常？

3. **查看实时计算**：
   
   选中商品后，页面下方应该显示：
   - **总重量**：应该是 50×2.5 + 30×3 = 125 + 90 = **215kg**
   - **总费用**：应该是 50×299 + 30×399 = 14950 + 11970 = **26920元**
   
   - **Bug检查**：这些计算是否实时更新？如果修改数量，计算是否正确？
   - **Bug检查**：如果选择了商品又取消，计算是否正确更新？

4. **选择车型**：
   
   点击"选择车型"，选择任意车型
   - **观察点**：选择车型后，是否显示载重进度？
   - **Bug检查**：如果订单重量超过车型载重，是否有提示？

5. **促销活动**（如果有）：
   
   如果之前创建了促销活动，系统应该自动检测并计算赠品
   - **观察点**：促销赠品是否正确显示？
   - **Bug检查**：赠品是否包含在总费用计算中？（通常赠品不应该收费）

6. **填写其他信息**：
   
   - **司机电话**：输入`13600136001`
     - **Bug检查**：输入非手机号格式会怎样？不填写会怎样？
   
   - **上传发货照片**：上传1-3张照片
     - **观察点**：多图上传是否正常？图片会自动上传到服务器（不再是blob URL），上传成功后显示服务器URL
     - **Bug检查**：能否预览？能否删除？刷新页面后图片是否仍然显示？
   
   - **备注**（可选）：输入`订单o1`

7. **创建订单**：点击底部的"创建订单"按钮
   - **观察点**：是否有加载提示？创建成功后是否跳转到订单详情页？
   - **Bug检查**：订单金额26920元，张三余额41920元，应该可以创建。如果余额不足，是否有提示？

**验证订单1结果**：

1. **查看订单详情**：
   - 确认商品、数量、金额是否正确
   - 总费用应该是26920元
   - 总重量应该是215kg

2. **验证余额变化**：
   - 返回张三详情页，余额应该变成 **41920 - 26920 = 15000元**（正好是目标余额！）
   - **Bug检查**：余额计算是否正确？

3. **更新订单状态**：
   - 在订单详情页，找到订单状态，更新为"已完成"
   - **观察点**：状态更新是否成功？是否保存？

#### 订单2：李四的订单（目标：创建后余额为-1500元）

**重要说明**：李四当前余额是28400元，订单金额29900元，创建订单后余额会变成 28400 - 29900 = **-1500元**（正好是目标余额！）

1. **选择代理商**：选择"李四"
   - **观察点**：李四的余额应该显示28400元

2. **选择商品和数量**：
   - 需要选择商品使总金额达到**29900元**
   - **推荐方案**：芒果果汁 100箱 = 100 × 299 = 29900元
   - 或者组合其他商品，例如：
     - 芒果果汁 50箱 + 金桂茶 50箱 = 14950 + 19950 = 34900元（需要调整）
     - 芒果果汁 80箱 + 茉莉茶 12箱 = 23920 + 5988 = 29908元（接近29900元）

3. **查看实时计算**：
   - 确认总费用接近或等于**29900元**
   - **Bug检查**：计算是否实时更新？

4. **选择车型**：选择任意车型

5. **填写其他信息**：
   - **司机电话**：输入`13600136002`
   - **上传发货照片**：上传1-3张照片
   - **备注**（可选）：输入`订单o2`

6. **创建订单**：点击"创建订单"按钮
   - **观察点**：创建是否成功？是否跳转到订单详情页？

**验证订单2结果**：

1. **查看订单详情**：
   - 确认商品、数量、金额是否正确
   - 总费用应该是29900元（或接近）

2. **验证余额变化**：
   - 返回李四详情页，余额应该变成 **28400 - 29900 = -1500元**（负数，红色显示）
   - **Bug检查**：负数余额是否用红色显示？
   - **Bug检查**：余额计算是否正确？

3. **更新订单状态**：
   - 在订单详情页，更新订单状态为"已发货"
   - **观察点**：状态更新是否成功？

#### 订单3：王五的订单（目标：创建后余额为28500元）

**重要说明**：王五当前余额是60440元，订单金额31940元，创建订单后余额会变成 60440 - 31940 = **28500元**（正好是目标余额！）

1. **选择代理商**：选择"王五"
   - **观察点**：王五的余额应该显示60440元

2. **选择商品和数量**：
   - 需要选择商品使总金额达到**31940元**
   - **推荐方案**：
     - 芒果果汁 50箱 + 茉莉茶 35箱 = 14950 + 17465 = 32415元（略超，可调整）
     - 芒果果汁 50箱 + 茉莉茶 34箱 = 14950 + 16966 = 31916元（接近31940元）
     - 芒果果汁 60箱 + 金桂茶 35箱 = 17940 + 13965 = 31905元（接近31940元）

3. **查看实时计算**：
   - 确认总费用接近或等于**31940元**
   - **Bug检查**：计算是否实时更新？

4. **选择车型**：选择任意车型

5. **填写其他信息**：
   - **司机电话**：输入`13600136001`
   - **上传发货照片**：上传1-3张照片
   - **备注**（可选）：输入`订单o3`

6. **创建订单**：点击"创建订单"按钮
   - **观察点**：创建是否成功？是否跳转到订单详情页？

**验证订单3结果**：

1. **查看订单详情**：
   - 确认商品、数量、金额是否正确
   - 总费用应该是31940元（或接近）

2. **验证余额变化**：
   - 返回王五详情页，余额应该变成 **60440 - 31940 = 28500元**（正好是目标余额！）
   - **Bug检查**：余额计算是否正确？

3. **订单状态**：
   - 订单状态保持"待发货"（不需要更新）

---

### 第四步：最终验证

创建完所有订单后，进行最终验证：

1. **验证所有代理商余额**：
   - **张三**：应该是**15000元** ✅
   - **李四**：应该是**-1500元**（负数，红色显示）✅
   - **王五**：应该是**28500元** ✅
   - **赵六**：应该是**8200元** ✅
   - **啊**：应该是**0元** ✅
   - **Bug检查**：所有余额计算是否正确？负数余额是否用红色显示？

2. **查看所有订单**：
   - 进入订单列表页面
   - 应该能看到3个订单（张三、李四、王五）
   - **Bug检查**：订单列表是否能按时间排序？能否按代理商筛选？
   - **Bug检查**：订单信息是否正确？金额、时间是否正确？

3. **验证任务完成率**：
   - 在代理详情页，查看"年度任务完成率"
   - 张三应该有订单中的商品数量计入完成率（芒果果汁50箱、金桂茶30箱）
   - 李四应该有订单中的商品数量计入完成率
   - 王五应该有订单中的商品数量计入完成率
   - **Bug检查**：完成率计算是否正确？是否排除了赠品？进度条显示是否正确？

4. **查看交易记录**：
   - 在代理详情页的"最近交易记录"中，应该能看到充值、扣款等记录
   - **Bug检查**：记录信息是否正确？金额是否正确？点击记录是否能查看详情？
   - **Bug检查**：订单扣款记录是否正确显示？

---

## 第三章：发现和测试边界情况

在完成基本的业务操作后，我们需要测试各种边界情况和异常场景，确保系统的健壮性。

### 测试场景1：余额不足的情况

**目的**：测试系统在余额不足或负数余额时的处理逻辑。

#### 操作步骤：

1. **让张三的余额变成负数**：
   - 进入张三的详情页，点击"充值"
   - 充值金额：`1000`元
   - 确认充值后，张三的余额应该是 15000 + 1000 = **16000元**
   
   - 然后创建一个5000元的订单：
     - 进入极速开单页面
     - 选择代理商：张三
     - 选择商品：芒果果汁，数量设置为约17箱（17 × 299 = 5083元，接近5000元）
     - 填写其他信息，创建订单
   
   - **观察点**：
     - 系统是否允许创建订单？（应该允许，因为余额足够）
     - 创建订单后，余额是否会正确扣款？
     - 如果继续创建更大的订单，使余额变成负数，系统是否允许？

2. **测试负数余额的显示**：
   - 如果余额变成了负数（比如-4000元）
   - **观察点**：
     - 负数余额是否用红色显示？
     - 在代理列表、详情页、代理端等不同位置，负数余额显示是否一致？

3. **在余额为负数时继续下单**：
   - 余额-4000元时，尝试创建一个1000元的订单
   - **观察点**：
     - 系统是否允许创建订单？
     - 余额是否会变成-5000元？
     - 是否有警告提示？

**Bug检查清单**：
- [ ] 负数余额是否正确显示为红色？
- [ ] 余额不足时是否有清晰的提示？
- [ ] 负数余额的计算是否正确？
- [ ] 在多个页面显示负数余额时，格式是否一致？

---

### 测试场景2：调货功能

**目的**：测试代理商之间的调货功能，特别是原子操作的完整性。

**重要说明**：调货功能是原子操作，必须确保两步同时成功或失败：
1. 给发货方退款（增加余额）
2. 从收货方扣款（减少余额）

#### 操作步骤：

1. **准备数据**：
   - 进入财务管理页面
   - 给张三充值10000元（如果余额不足）
   - 给李四充值5000元（如果余额不足）
   - **记录初始余额**：
     - 张三：______元
     - 李四：______元

2. **执行调货**：
   - 进入财务管理的**调货**功能（通常在财务管理页面有"调货"按钮或标签）
   - 选择发货方：**张三**（会收到退款）
   - 选择收货方：**李四**（会扣款）
   - 选择商品：选择一个已存在的商品（如芒果果汁）
   - 设置数量：`10`箱
   - 设置优惠：`0`元
   - 系统应该显示：调货金额 = 10 × 299 = **2990元**（根据实际商品价格计算）

3. **确认调货**：
   - 点击"确认调货"按钮
   - **观察点**：
     - 是否有加载提示？
     - 操作是否成功？
     - 是否有成功提示？

4. **验证调货结果**：
   - **检查余额变化**：
     - 进入张三详情页，余额应该增加了2990元
     - 进入李四详情页，余额应该减少了2990元
     - **计算公式**：
       - 张三新余额 = 原余额 + 2990元
       - 李四新余额 = 原余额 - 2990元
   
   - **检查交易记录**：
     - 在张三的交易记录中，应该能看到一条"调货收入"记录，金额+2990元
     - 在李四的交易记录中，应该能看到一条"调货支出"记录，金额-2990元
     - **Bug检查**：两条记录是否都正确生成？金额是否正确？

**Bug检查清单**：
- [ ] **关键**：这是原子操作！如果其中一步失败（比如网络问题），整个操作是否回滚？
- [ ] 调货后，两个代理商的余额是否正确？
- [ ] 交易记录是否正确生成？
- [ ] 如果调货金额超过收货方余额，系统如何处理？（应该允许，因为余额可以为负数）

---

### 测试场景3：补充数据功能

**目的**：验证补充数据功能只影响任务完成率，不影响余额。

**重要说明**：补充数据功能**只影响任务完成率，不影响余额**。这是最容易出错的地方！

#### 操作步骤：

1. **查看初始状态**：
   - 进入张三的详情页
   - 查看A产品完成率：当前完成______箱 / 目标500箱
   - 查看当前余额：______元
   - **记录初始值**，用于后续对比

2. **补充数据**：
   - 点击"补充数据"按钮
   - 选择产品类型：**A产品**
   - 输入数量：`50`箱
   - 选择日期：`2024-11-01`（历史日期）
   - 填写备注：`补录历史数据`
   - 点击"确认补充"

3. **验证结果**：
   - **检查任务完成率**：
     - 返回张三详情页，查看A产品完成率
     - 完成率应该增加了50箱
     - **计算公式**：新完成率 = 原完成率 + 50箱
   
   - **检查余额**（**关键测试**）：
     - 查看余额卡片，余额应该**保持不变**！
     - **Bug检查**：如果余额增加了，这是严重的bug！补充数据不应该影响余额。
   
   - **检查交易记录**：
     - 在交易记录中，应该能看到一条"补充数据"记录
     - **观察点**：记录是否显示？金额是否为0？或者是否不显示金额？

4. **测试边界情况**：
   - **补充负数数量**：
     - 尝试输入负数（如-10）
     - **预期**：系统应该不允许，显示错误提示
   
   - **补充0数量**：
     - 尝试输入0
     - **预期**：系统应该不允许，显示错误提示
   
   - **补充未来日期**：
     - 选择未来的日期（如2025-12-31）
     - **观察点**：系统是否允许？是否有提示？

**Bug检查清单**：
- [ ] **关键**：补充数据后，余额是否发生变化？（应该**不变**！）
- [ ] 任务完成率是否正确增加？
- [ ] 补充的数据是否在交易记录中显示？
- [ ] 负数、0、未来日期等边界情况是否有正确的验证？

---

### 测试场景4：促销活动

**目的**：测试促销活动的自动计算，特别是赠品是否计入费用和完成率。

#### 操作步骤：

1. **确认促销活动存在**：
   - 如果之前没有创建促销活动，先创建一个：
     - 进入促销管理页面
     - 创建活动：芒果果汁买100箱送8箱金桂茶
     - 设置活动时间、赠品商品
     - 保存

2. **测试促销活动**：
   - 进入极速开单页面
   - 选择一个代理商（比如张三，余额应该足够）
   - 选择商品：**芒果果汁**
   - 设置数量：`250`箱

3. **验证促销计算**：
   - **查看赠品计算**：
     - 系统应该自动检测促销活动并计算：
       - 250 ÷ 100 = 2（向下取整）
       - 赠品 = 2 × 8 = **16箱金桂茶**
     - **观察点**：
       - 赠品是否正确显示在订单中？
       - 赠品是否显示为"赠品"或特殊标记？
   
   - **查看订单金额**：
     - 订单总金额应该只计算250箱芒果果汁的钱
     - **计算公式**：250 × 299 = **74750元**
     - **Bug检查**：赠品是否包含在总费用计算中？（应该**不包括**！）
   
   - **查看订单详情**：
     - 在订单预览中，应该能看到：
       - 芒果果汁：250箱（付费）
       - 金桂茶：16箱（赠品，不收费）

4. **创建订单并验证**：
   - 填写其他信息（司机电话、发货照片等）
   - 创建订单
   - **验证订单详情**：
     - 订单金额应该是74750元（不包括赠品）
     - 订单中应该显示16箱金桂茶作为赠品
   
   - **验证任务完成率**（**关键测试**）：
     - 进入张三详情页，查看任务完成率
     - **Bug检查**：任务完成率中是否包含了赠品？（应该**不包括**赠品！只有250箱芒果果汁计入完成率）
     - 如果金桂茶是混合产品，混合产品完成率应该只增加250箱（如果有相关规则），不应该增加16箱赠品

**Bug检查清单**：
- [ ] 促销活动是否自动检测？
- [ ] 赠品计算是否正确？
- [ ] 订单金额是否只计算付费商品？（不包括赠品）
- [ ] **关键**：任务完成率中是否包含了赠品？（应该**不包括**！）
- [ ] 赠品是否在订单详情中正确显示？

---

### 测试场景5：图片上传的各种情况

**目的**：测试图片上传功能的健壮性和性能。

#### 操作步骤：

1. **正常上传**：
   - 在任意需要上传图片的地方（如商品图片、凭证图片）
   - 上传1-5张图片
   - **观察点**：
     - 上传是否正常？
     - 上传进度是否显示？
     - 上传后是否显示预览？

2. **大图片测试**：
   - 准备一张10MB以上的图片
   - 尝试上传
   - **观察点**：
     - 上传是否会卡顿？
     - 是否会失败？
     - 是否有压缩处理？
     - 是否有文件大小限制提示？

3. **多图上传**：
   - 一次性上传20张图片
   - **观察点**：
     - 上传是否正常？
     - 是否会卡顿？
     - 上传进度是否正确显示？
     - 所有图片是否都能成功上传？

4. **图片重复检测**（如果系统支持）：
   - 上传一张之前用过的转账凭证图片
   - **观察点**：
     - 是否有查重提示？
     - 提示是否清晰？

5. **删除图片**：
   - 上传图片后，点击删除按钮（×）
   - **观察点**：
     - 删除是否正常？
     - 删除后图片是否从列表中移除？
     - 刷新页面后，图片是否真的被删除？

**Bug检查清单**：
- [ ] 正常上传是否流畅？
- [ ] 大图片是否有处理（压缩或限制）？
- [ ] 多图上传是否会卡顿？
- [ ] 图片删除功能是否正常？
- [ ] 上传的图片URL是否是服务器URL？（不是blob URL）

---

### 测试场景6：数据统计的准确性

**目的**：验证各种数据统计是否正确，特别是排除赠品、包含补充数据等规则。

#### 操作步骤：

1. **数据驾驶舱统计**：
   - 进入数据驾驶舱页面
   - 查看"年度总发货量"
   - **验证**：
     - 统计是否包含了所有订单？
     - 是否排除了赠品？
     - 数量是否正确？
   
   - 查看"产品分布"
   - **验证**：
     - 各产品的发货量是否正确？
     - 是否排除了赠品？

2. **代理详情页统计**：
   - 进入某个代理商的详情页
   - 查看"年度任务完成率"
   - **验证**：
     - 完成率计算是否正确？
     - **关键**：赠品是否被计入完成率？（应该**不包括**）
     - **关键**：补充数据是否被计入？（应该**包括**）
     - 进度条显示是否正确？

3. **交易记录统计**：
   - 在财务管理页面，查看交易记录
   - **验证**：
     - 记录总数是否正确？
     - 按代理商筛选是否正常？
     - 按类型筛选是否正常？

**Bug检查清单**：
- [ ] 数据驾驶舱的统计是否正确？
- [ ] **关键**：赠品是否被计入统计？（应该**不包括**）
- [ ] **关键**：补充数据是否被计入完成率？（应该**包括**）
- [ ] 各种筛选功能是否正常？

---

## 第四章：代理端功能测试

现在切换身份，以代理商"张三"的身份登录，测试代理端功能。

**目的**：从代理商的角度测试系统，确保代理端功能正常。

### 第一步：切换到代理端

1. **切换账号**：
   - 在管理端页面，点击右上角"切换账号"按钮
   - 返回首页，你会看到两个选择：**管理端** 和 **代理端**
   - 点击**代理端**

2. **选择代理商**：
   - 系统会弹出代理商列表
   - 选择"张三"（或其他已创建的代理商）
   - **观察点**：
     - 代理商列表是否正常显示？
     - 选择后是否成功进入代理端？

### 第二步：查看业绩首页

进入代理端首页，你应该能看到以下内容：

1. **余额卡片**：
   - 显示当前余额（根据之前的操作，张三应该是15000元）
   - **Bug检查**：
     - 如果余额是负数，是否用红色显示？
     - 余额数字是否正确？
     - 余额格式是否清晰（如：15,000元）？

2. **年度任务进度**：
   - **A产品完成率**：
     - 显示已完成/目标（如：60/500）
     - 显示进度条
   - **混合产品完成率**：
     - 显示已完成/目标（如：30/300）
     - 显示进度条
   - **Bug检查**：
     - 完成率计算是否正确？
     - 进度条显示是否正确？
     - 数字格式是否清晰？

3. **促销进度**（如果有促销活动）：
   - 显示已购数量、已获赠品数量
   - **Bug检查**：
     - 数据是否正确？
     - 显示是否清晰？

### 第三步：查看我的订单

点击"我的订单"或底部导航的"订单"标签，进入订单列表页面：

1. **订单列表**：
   - 应该能看到之前创建的订单（张三的订单）
   - **观察点**：
     - 订单信息是否正确？金额、时间是否正确？
     - 订单状态是否正确显示？
   - **Bug检查**：
     - 如果订单很多，列表是否能正常滚动？
     - 能否按时间排序？
     - 能否按状态筛选？

2. **订单详情**：
   - 点击某个订单，查看详情
   - **观察点**：
     - 详情信息是否完整？
     - 商品列表是否正确？
     - 订单金额是否正确？
   - **Bug检查**：
     - 如果订单有促销赠品，是否在详情中显示？
     - 赠品是否标记为"赠品"？

3. **分享订单**（如果功能存在）：
   - 如果订单详情页有"分享"按钮，点击分享
   - **Bug检查**：
     - 分享链接是否正常生成？
     - 打开分享链接后，能否看到订单信息？
     - 分享链接是否需要登录？

### 第四步：查看余额明细

进入"余额明细"页面（通常在底部导航或首页有入口）：

1. **交易记录列表**：
   - 应该能看到所有交易记录（充值、扣款、调货等）
   - **观察点**：
     - 记录是否正确？
     - 金额正负是否用颜色区分？（收入用绿色，支出用红色）
     - 时间显示是否正确？
   - **Bug检查**：
     - 记录是否按时间倒序排列？
     - 记录信息是否完整？

2. **筛选功能**：
   - 点击"充值"筛选，应该只显示充值记录
   - 点击"扣款"筛选，应该只显示扣款记录
   - 点击"全部"筛选，应该显示所有记录
   - **Bug检查**：
     - 筛选是否正常工作？
     - 筛选后记录数量是否正确？

3. **记录详情**：
   - 点击某条记录，查看详情（如果支持）
   - **观察点**：
     - 详情信息是否完整？
     - 凭证图片是否显示？（如果是充值记录）

### 第五步：素材下载

进入"素材"页面（通常在底部导航有"素材"标签）：

1. **商品列表**：
   - 应该能看到所有商品
   - **观察点**：
     - 商品列表是否正常显示？
     - 商品信息是否正确？

2. **素材预览**：
   - 点击某个商品，查看素材图片
   - **观察点**：
     - 素材图片是否正常显示？
     - 能否放大查看？
     - 图片加载速度如何？

3. **下载功能**：
   - 尝试下载素材图片
   - **Bug检查**：
     - 下载是否正常？
     - 能否批量下载？
     - 下载的文件名是否正确？

**Bug检查清单**：
- [ ] 代理端首页信息是否正确？
- [ ] 余额显示是否正确？（特别是负数余额）
- [ ] 任务完成率计算是否正确？
- [ ] 订单列表和详情是否正确？
- [ ] 余额明细和筛选功能是否正常？
- [ ] 素材下载功能是否正常？

---

## 第五章：发现bug的常见模式

在测试过程中，特别注意以下容易出bug的地方。建议在测试时，针对每个模式都进行验证。

### 1. 数据计算错误

这是最常见的bug类型，需要仔细验证：

- **余额计算**：
  - 充值、扣款、调货后，余额是否正确？
  - 负数余额计算是否正确？
  - 多个操作连续进行时，余额是否正确累加？

- **任务完成率**：
  - 是否排除了赠品？（**关键**）
  - 是否包含了补充数据？（**关键**）
  - 订单中的商品数量是否正确计入？

- **订单金额**：
  - 是否包含了赠品？（应该**不包括**）
  - 促销优惠是否正确计算？
  - 多个商品的总金额是否正确？

### 2. 输入验证问题

确保系统对用户输入有正确的验证：

- **必填项**：
  - 不填写必填项，是否有清晰的错误提示？
  - 错误提示是否指明了哪个字段？

- **格式验证**：
  - 手机号格式是否正确验证？（11位数字）
  - 金额格式是否正确验证？（不能为负数、不能为0等）
  - 日期格式是否正确验证？

- **边界值**：
  - 负数是否有处理？
  - 0值是否有处理？
  - 超大数字是否有处理？
  - 空字符串是否有处理？

### 3. 状态同步问题

确保数据在不同页面之间保持一致：

- **实时更新**：
  - 操作后，相关页面是否实时更新？
  - 是否需要手动刷新才能看到最新数据？

- **数据一致性**：
  - 余额在多个地方显示（列表、详情页、代理端），是否一致？
  - 订单状态在列表和详情页是否一致？
  - 任务完成率在多个位置显示是否一致？

### 4. 用户体验问题

确保用户操作流畅，提示清晰：

- **加载提示**：
  - 操作是否有加载提示？（如"处理中..."）
  - 用户是否知道系统在处理？

- **错误提示**：
  - 错误提示是否清晰？
  - 用户是否知道如何修正？
  - 错误提示是否用红色或其他醒目的颜色？

- **空状态**：
  - 没有数据时，是否有友好的空状态提示？
  - 空状态是否有引导用户操作的提示？

### 5. 性能问题

确保系统在处理大量数据时不会卡顿：

- **大量数据**：
  - 如果有很多代理商（50+），列表是否能正常滚动？
  - 如果有很多订单（1000+），列表是否能正常加载？
  - 搜索功能在大量数据下是否正常？

- **图片上传**：
  - 上传大图片是否会卡顿？
  - 上传很多图片是否会卡顿？
  - 图片压缩是否有效？

### 6. 业务逻辑问题

确保业务规则正确实现：

- **原子操作**：
  - 调货功能是否真的是原子操作？（**关键**）
  - 如果其中一步失败，是否回滚？

- **业务规则**：
  - 促销赠品是否计入任务完成率？（应该**不包括**）
  - 补充数据是否影响余额？（应该**不影响**）
  - 订单创建时，余额不足是否允许？（根据业务规则）

---

## 第六章：测试清单（用于记录bug）

在测试过程中，建议记录以下信息：

```
日期：__________
测试人员：__________

【Bug记录】

Bug #1：
- 位置：__________
- 操作步骤：__________
- 预期结果：__________
- 实际结果：__________
- 截图：__________

Bug #2：
...

【功能验证】

✅ 商品管理：正常/异常
✅ 代理管理：正常/异常
✅ 充值功能：正常/异常
✅ 订单创建：正常/异常
✅ 调货功能：正常/异常
✅ 补充数据：正常/异常
✅ 数据统计：正常/异常
✅ 代理端查看：正常/异常
```

---

## 结语

按照这个指南操作，你应该能够：

1. **恢复完整数据**：通过手动操作，将数据库中的数据在系统中重新创建出来
2. **熟悉系统**：了解每个功能的作用和操作方式
3. **发现bug**：通过实际操作用户场景，发现功能性问题
4. **理解业务**：理解微商代理管理的业务流程

**操作顺序建议**：

1. **第一次操作**：按照文档顺序完整走一遍
   - **第一章**：系统初始化
     - 添加4个商品
     - 添加3个收款账户
     - 添加5个代理商
     - 创建2个促销活动（如果界面支持）
   - **第二章**：处理业务
     - 明确目标余额并计算充值金额
     - 为代理商充值（根据计算好的金额）
     - 创建3个订单（创建后余额会自动达到目标值）
     - 最终验证所有余额和订单
   - **第三章**：测试边界情况
     - 测试余额不足的情况
     - 测试调货功能（原子操作）
     - 测试补充数据功能（不影响余额）
     - 测试促销活动（赠品不计入费用和完成率）
     - 测试图片上传的各种情况
     - 验证数据统计的准确性
   - **第四章**：代理端功能测试
     - 切换到代理端
     - 查看业绩首页
     - 查看订单和余额明细
     - 测试素材下载功能

2. **第二次操作**：重点关注边界情况和异常情况
   - 按照第三章的测试场景，逐一验证每个边界情况
   - 记录所有发现的问题

3. **记录问题**：记录所有发现的问题，包括：
   - Bug（功能性问题）
   - 体验问题（操作不便、提示不清等）
   - 性能问题（卡顿、加载慢等）

**重要提醒**：

- **余额计算**：创建订单会自动扣款，所以需要**提前计算充值金额**，确保创建订单后余额达到目标值。第二章已经详细说明了计算方法。
- **顺序很重要**：先添加商品 → 再添加代理商 → 然后充值（按计算好的金额） → 最后创建订单（会扣款，余额自动达到目标值）
- **某些功能可能需要API**：如果收款账户创建、促销活动创建等功能在界面中找不到，可能需要通过后端API创建
- **时间问题**：交易记录和订单的时间会自动设置为当前时间，无法精确还原到数据库中的时间
- **关键测试点**：
  - 调货功能必须是原子操作（两步同时成功或失败）
  - 补充数据不影响余额（只影响任务完成率）
  - 促销赠品不计入订单费用和任务完成率

**记住**：最好的测试就是像真实用户一样使用系统。如果你在使用过程中感到困惑或不方便，那可能就是需要改进的地方。通过这些具体的操作步骤，你既能恢复数据，又能全面测试系统功能。

祝你测试顺利！ 🚀

