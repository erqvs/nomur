# Nomur 微商代理管理系统 - 操作验证手册

> **系统地址**：https://nomur.linkmate.site

---

## 第一部分：系统概述

### 这是什么系统？

Nomur 是一个 **代理商订货与财务管理平台**，适用于：
- 食品批发公司
- 农产品经销商
- 快消品分销商
- 任何有代理商网络的 B2B 企业

### 核心解决的问题

| 问题 | 解决方案 |
|------|----------|
| 代理商订了多少货？ | 订单记录系统 |
| 代理商还欠多少钱？ | 余额管理（支持负数/欠款） |
| 怎么凑满一车发货？ | 整车计算系统 |
| 代理商年度任务完成多少了？ | 业绩追踪（排除赠品） |
| 促销活动送了多少赠品？ | 自动计算搭赠 |
| 代理之间调货怎么结算？ | 原子操作双向记账 |
| 转账截图会不会重复使用？ | 图片查重功能 |

### 两种角色

| 角色 | 说明 | 能做什么 |
|------|------|----------|
| **管理端** | 公司/创始人 | 开单、充值、扣款、调货、管理代理、管理商品、设置促销 |
| **代理端** | 代理商/客户 | 查看自己的订单、余额、任务进度、下载素材 |

---

## 第二部分：场景与操作手册

---

### 场景 1：进入系统并切换角色

#### 背景
公司有管理员和多个代理商，不同人需要看到不同的界面。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 打开 https://nomur.linkmate.site | 显示角色选择页面，蓝色背景，显示 Logo「N」和「请选择您的身份」 |
| 2 | 点击「管理端」卡片 | 进入管理后台首页（数据驾驶舱），底部显示4个Tab |
| 3 | 点击首页右上角「切换账号」 | 返回角色选择页面 |
| 4 | 点击「代理端」卡片 | 弹出代理商选择列表，显示所有代理商 |
| 5 | 选择「张三」 | 进入张三的代理端首页，显示张三的个人数据 |
| 6 | 进入「个人中心」点击「切换账号」 | 返回角色选择页面 |

#### 验证要点
- [ ] 管理端可以看到所有代理商数据
- [ ] 代理端只能看到自己的数据
- [ ] 切换账号功能正常

---

### 场景 2：管理员查看公司整体数据

#### 背景
老板想知道今年公司总共发了多少货，各产品分别发了多少。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 以管理端身份进入系统 | 进入数据驾驶舱 |
| 2 | 查看顶部两个统计卡片 | 显示「年总发货箱数」和「近30天出库」的数字 |
| 3 | 查看「年度发货分布」区域 | 显示4个产品（A/B/C/D）的发货量和进度条 |
| 4 | 查看「近30天发货分布」区域 | 显示4个产品的近期发货量 |
| 5 | 查看「代理商列表」 | 显示所有代理商，包含头像、名称、电话、余额 |
| 6 | 观察余额为负数的代理 | 负数余额显示为红色（如「-¥1,500」） |

#### 验证要点
- [ ] 统计数据正确显示
- [ ] 负数余额显示红色
- [ ] 进度条按比例显示

---

### 场景 3：给代理商开单发货（核心功能）

#### 背景
代理商张三打电话说要订 100 箱 A 产品、50 箱 B 产品，需要记录订单并自动扣款。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击底部 Tab「开单」 | 进入极速开单页面 |
| 2 | 在「选择代理商」区域点击「张三」标签 | 标签变蓝，下方显示张三当前余额 |
| 3 | 在「选择商品」区域点击「A产品-经典款」 | 商品卡片出现蓝色边框和✓勾选 |
| 4 | 点击「+10」按钮 10 次，使数量变为 100 | 数量显示 100，底部实时更新总计 |
| 5 | 点击「B产品-升级版」 | 第二个商品被选中，默认数量 10 |
| 6 | 将 B 产品数量改为 50 | 直接输入或使用加减按钮 |
| 7 | 观察底部计算区域 | **实时显示**：总数量 150 箱、总重量、总金额 |
| 8 | 在「选择司机」区域选择一个司机 | 司机标签变蓝 |
| 9 | 点击「确认开单」 | 显示「开单成功」提示 |
| 10 | 返回首页查看张三的余额 | **余额已自动减少**，减少金额 = 订单金额 |

#### 验证要点
- [ ] 商品选择使用勾选方式，不是下拉菜单
- [ ] 数量变化时，总计**毫秒级**实时更新
- [ ] 开单后余额自动扣减
- [ ] 所有选择都是勾选式，无下拉菜单

---

### 场景 4：整车计算（物流配载）

#### 背景
公司发货使用35吨大货车，需要凑够 35,300kg - 35,400kg 才能发整车，否则运费不划算。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 进入「开单」页面 | 看到「整车计算」区域 |
| 2 | 点击「选择车型」按钮 | 弹出车型选择列表 |
| 3 | 查看可选车型 | 显示：标准整车（35,300-35,400kg）、中型货车、小型货车 |
| 4 | 选择「标准整车」 | 弹窗关闭，显示整车进度条 |
| 5 | 选择一些商品，总重量 5,000kg | 进度条显示橙色，状态显示「⚠️ 重量不足」 |
| 6 | 查看提示文字 | 显示「还差 30,300kg 达到整车」 |
| 7 | 继续增加商品，使总重量达到 35,350kg | 进度条变绿色，状态显示「✅ 整车达标！」 |
| 8 | 继续增加商品，使总重量超过 35,400kg | 进度条变红色，状态显示「❌ 超载」 |
| 9 | 在超载状态点击「确认开单」 | 系统阻止提交，提示「超载，请减少商品」 |
| 10 | 在「重量不足」状态点击「确认开单」 | 弹出确认框询问是否继续 |

#### 验证要点
- [ ] 整车进度条实时变化
- [ ] 三种状态（不足/达标/超载）颜色不同
- [ ] 超载时阻止开单
- [ ] 可切换不同车型

---

### 场景 5：促销活动自动计算赠品

#### 背景
公司正在搞促销「每满100件赠送5件A产品」，开单时需要自动计算赠品。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 进入「开单」页面 | - |
| 2 | 选择代理商和商品，数量设为 99 件 | - |
| 3 | 在「参与促销」区域选择「年终大促」 | - |
| 4 | 观察底部计算区域 | **不显示**赠品信息（未满100件） |
| 5 | 将数量改为 100 件 | 显示「🎁 赠品：A产品-经典款 x5」 |
| 6 | 将数量改为 250 件 | 显示「🎁 赠品：A产品-经典款 x10」（满100两次） |
| 7 | 确认开单 | 订单中包含赠品信息 |
| 8 | 切换到代理端查看该代理的「年度任务进度」 | **赠品不计入**年度任务完成量 |

#### 验证要点
- [ ] 赠品数量随购买数量实时计算
- [ ] 满足条件才显示赠品
- [ ] 赠品不计入年度销售任务

---

### 场景 6：给代理商充值（含凭证查重）

#### 背景
代理商李四转账 5 万元到公司账户，财务需要录入充值记录，并上传转账截图作为凭证。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击底部 Tab「财务」 | 进入财务管理页面 |
| 2 | 点击「充值」按钮 | 弹出充值表单 |
| 3 | 选择代理商「李四」 | 标签变蓝 |
| 4 | 选择充值原因「代理打款」 | 标签变蓝 |
| 5 | 输入金额「50000」 | - |
| 6 | 点击上传凭证，选择一张转账截图 | 图片预览显示 |
| 7 | 点击「确认充值」 | 显示「充值成功」，李四余额 +50000 |
| 8 | **再次**对另一个代理充值，上传**同一张**截图 | 系统提示「该转账截图已被使用过，请上传新的截图」 |

#### 验证要点
- [ ] 充值后余额正确增加
- [ ] 必须上传凭证图片
- [ ] 重复图片被拦截

---

### 场景 7：给代理商扣款

#### 背景
代理商王五因违规被罚款 1000 元。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 进入「财务」页面 | - |
| 2 | 点击「扣款」按钮 | 弹出扣款表单 |
| 3 | 选择代理商「王五」 | - |
| 4 | 选择扣款原因「罚款」 | - |
| 5 | 输入金额「1000」 | - |
| 6 | 点击「确认扣款」 | 显示「扣款成功」，王五余额 -1000 |

#### 验证要点
- [ ] 扣款后余额正确减少
- [ ] 扣款原因可选择「罚款」或「发货扣款」

---

### 场景 8：代理商之间调货

#### 背景
代理 A 在深圳急需货，代理 B 在广州有库存愿意调给 A。需要在系统中记录，给 B 退款，从 A 扣款。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 记录当前：A 余额 10,000，B 余额 5,000 | - |
| 2 | 进入「财务」页面，点击「调货」按钮 | 弹出调货表单 |
| 3 | 选择发货方（收款）：B | B 是发货的，应该收到退款 |
| 4 | 选择收货方（付款）：A | A 是收货的，应该被扣款 |
| 5 | 输入调货金额「2000」 | - |
| 6 | 点击「确认调货」 | 显示「调货成功」 |
| 7 | 查看 A 的余额 | 变为 8,000（-2000） |
| 8 | 查看 B 的余额 | 变为 7,000（+2000） |
| 9 | 查看财务流水 | 同时出现两条记录：A 调货支出 -2000，B 调货收入 +2000 |

#### 验证要点
- [ ] 调货是原子操作，两边同时变化
- [ ] 发货方余额增加（收到退款）
- [ ] 收货方余额减少（支付货款）
- [ ] 流水记录完整

---

### 场景 9：管理商品

#### 背景
公司需要添加新产品、修改产品信息、上传产品宣传素材。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击底部 Tab「商品」 | 进入商品管理页面 |
| 2 | 查看商品列表 | 显示所有商品，包含图片、名称、价格、重量、素材数量 |
| 3 | 点击任意商品卡片 | 进入商品编辑页面 |
| 4 | 修改商品价格，点击保存 | 返回列表，价格已更新 |
| 5 | 点击底部「添加商品」按钮 | 进入空白编辑页面 |
| 6 | 填写商品信息（名称、价格、重量、图片） | - |
| 7 | 点击保存 | 返回列表，新商品已添加 |

#### 验证要点
- [ ] 商品列表显示完整信息
- [ ] 可以编辑现有商品
- [ ] 可以添加新商品

---

### 场景 10：管理代理商

#### 背景
公司新增了一个代理商，需要录入系统。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 在首页点击「代理管理」 | 进入代理商列表页面 |
| 2 | 查看代理商列表 | 显示所有代理商 |
| 3 | 点击「添加代理」按钮 | 进入代理商编辑页面 |
| 4 | 填写信息：头像、名称、2个手机号、地址 | - |
| 5 | 设置年度任务：A产品目标 5000 箱，混合产品目标 3000 箱 | - |
| 6 | 点击保存 | 返回列表，新代理已添加，初始余额为 0 |

#### 验证要点
- [ ] 可以添加新代理商
- [ ] 可以设置年度任务目标
- [ ] 新代理初始余额为 0

---

### 场景 11：管理促销活动

#### 背景
公司要设置新的促销活动「春节大促：每满 200 件送 10 件 B 产品」。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 在首页点击「促销管理」 | 进入促销活动页面 |
| 2 | 查看活动列表 | 显示现有活动，包含名称、规则、状态 |
| 3 | 点击「添加促销活动」 | 弹出添加表单 |
| 4 | 填写活动名称「春节大促」 | - |
| 5 | 填写活动说明「每满200件送10件B产品」 | - |
| 6 | 设置满足条件：200 件 | - |
| 7 | 选择赠品产品「B产品」，数量 10 | 使用勾选方式选择产品 |
| 8 | 设置活动时间 | - |
| 9 | 点击「确认添加」 | 新活动出现在列表中 |

#### 验证要点
- [ ] 可以添加新促销活动
- [ ] 赠品选择使用勾选方式
- [ ] 活动显示在开单页面的促销选项中

---

### 场景 12：代理商查看自己的业绩

#### 背景
代理商张三想知道自己今年完成了多少任务、账户还剩多少钱。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 以「张三」身份进入代理端 | 进入代理端首页 |
| 2 | 查看顶部个人信息 | 显示张三的头像、名称、电话 |
| 3 | 查看余额卡片 | 显示当前余额，负数为红色 |
| 4 | 查看「年度任务进度」 | 显示 A 产品完成量/目标、混合产品完成量/目标 |
| 5 | 观察进度条 | 完成率以百分比和进度条形式显示 |
| 6 | 查看「促销活动进度」 | 显示已购买数量、已获赠品数量 |

#### 验证要点
- [ ] 只显示自己的数据
- [ ] 年度任务统计**不包含**赠品
- [ ] 余额正确显示（含负数）

---

### 场景 13：代理商查看订单记录

#### 背景
代理商想查看自己所有的订单历史。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 在代理端首页点击「我的订单」 | 进入订单列表页面 |
| 2 | 查看筛选标签 | 显示：全部、待发货、已发货、已完成（带数量徽章） |
| 3 | 点击「待发货」标签 | 只显示待发货的订单 |
| 4 | 查看订单卡片 | 显示：订单号、状态、商品明细、总重量、总金额、时间、司机 |
| 5 | 查看有赠品的订单 | 底部显示「🎁 赠品：xxx」 |

#### 验证要点
- [ ] 只显示自己的订单
- [ ] 可按状态筛选
- [ ] 赠品信息正确显示

---

### 场景 14：代理商查看余额明细

#### 背景
代理商想查看自己账户的所有收支记录。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 在代理端点击「余额明细」 | 进入流水列表页面 |
| 2 | 查看流水列表 | 显示所有充值/扣款记录 |
| 3 | 观察充值记录 | 绿色 +金额，原因可能是：赠送、代理打款 |
| 4 | 观察扣款记录 | 红色 -金额，原因可能是：发货扣款、罚款、调货支出 |
| 5 | 观察调货记录 | 调货收入显示 +金额，调货支出显示 -金额 |

#### 验证要点
- [ ] 只显示自己的流水
- [ ] 收支金额颜色区分
- [ ] 交易原因明确

---

### 场景 15：代理商下载宣传素材

#### 背景
代理商需要下载产品海报用于推广。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 在代理端点击「素材下载」 | 进入素材下载页面 |
| 2 | 查看产品选择标签 | 显示所有产品，可切换 |
| 3 | 点击不同产品标签 | 切换显示该产品的素材图片 |
| 4 | 点击任意图片 | 进入大图预览模式 |
| 5 | 长按图片 | 提示保存到相册 |
| 6 | 点击「保存全部素材到相册」 | 批量保存所有图片 |

#### 验证要点
- [ ] 可按产品切换素材
- [ ] 图片可预览
- [ ] 可保存图片

---

### 场景 16：查看收款账户的收款明细

#### 背景
财务想查看「公司对公账户」一共收到了多少打款。

#### 操作步骤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 进入财务管理页面 | - |
| 2 | 点击收款账户（如「公司对公账户」） | 显示该账户的收款明细 |
| 3 | 查看明细列表 | 显示：哪个代理、打款金额、打款时间 |
| 4 | 查看汇总信息 | 显示：总收款笔数、总收款金额 |

#### 验证要点
- [ ] 可查看每个收款账户的明细
- [ ] 显示打款代理信息
- [ ] 汇总数据正确

---

## 第三部分：功能清单验证表

请在验证后打勾 ✓

### 管理端功能

| 模块 | 功能 | 状态 |
|------|------|------|
| **角色切换** | 选择管理端/代理端 | ☐ |
| | 切换账号返回选择页 | ☐ |
| **数据驾驶舱** | 年总发货箱数统计 | ☐ |
| | 近30天出库统计 | ☐ |
| | 按产品分布统计 | ☐ |
| | 代理商列表展示 | ☐ |
| | 负数余额红色显示 | ☐ |
| **极速开单** | 勾选式选择代理商 | ☐ |
| | 勾选式选择商品 | ☐ |
| | 数量加减按钮 | ☐ |
| | 实时计算总量/重量/金额 | ☐ |
| | 整车计算进度条 | ☐ |
| | 车型切换 | ☐ |
| | 整车状态提示（不足/达标/超载） | ☐ |
| | 勾选式选择司机 | ☐ |
| | 勾选式选择促销活动 | ☐ |
| | 自动计算赠品 | ☐ |
| | 开单后自动扣款 | ☐ |
| | 超载阻止提交 | ☐ |
| **商品管理** | 商品列表展示 | ☐ |
| | 添加新商品 | ☐ |
| | 编辑商品信息 | ☐ |
| **代理管理** | 代理商列表展示 | ☐ |
| | 添加新代理商 | ☐ |
| | 设置年度任务目标 | ☐ |
| **财务管理** | 充值功能 | ☐ |
| | 充值凭证上传 | ☐ |
| | 凭证图片查重 | ☐ |
| | 扣款功能 | ☐ |
| | 调货功能（原子操作） | ☐ |
| | 收款账户明细查询 | ☐ |
| **促销管理** | 促销活动列表 | ☐ |
| | 添加新促销活动 | ☐ |

### 代理端功能

| 模块 | 功能 | 状态 |
|------|------|------|
| **业绩首页** | 个人信息展示 | ☐ |
| | 余额展示（含负数） | ☐ |
| | 年度任务进度（排除赠品） | ☐ |
| | 促销活动进度 | ☐ |
| | 已获赠品总数 | ☐ |
| **我的订单** | 订单列表展示 | ☐ |
| | 按状态筛选 | ☐ |
| | 订单详情（含赠品） | ☐ |
| **余额明细** | 流水列表展示 | ☐ |
| | 收支颜色区分 | ☐ |
| **素材下载** | 按产品切换 | ☐ |
| | 图片预览 | ☐ |
| | 保存图片 | ☐ |
| **个人中心** | 个人信息 | ☐ |
| | 切换账号 | ☐ |

---

## 第四部分：API 验证

可通过以下命令验证后端接口：

```bash
# 1. 健康检查
curl https://nomur.linkmate.site/api/health

# 2. 获取商品列表
curl https://nomur.linkmate.site/api/products

# 3. 获取代理商列表
curl https://nomur.linkmate.site/api/agents

# 4. 获取订单列表
curl https://nomur.linkmate.site/api/orders

# 5. 获取交易流水
curl https://nomur.linkmate.site/api/transactions

# 6. 获取统计数据
curl https://nomur.linkmate.site/api/statistics

# 7. 获取车型列表
curl https://nomur.linkmate.site/api/truck-types

# 8. 获取促销活动
curl https://nomur.linkmate.site/api/promotions

# 9. 获取收款账户
curl https://nomur.linkmate.site/api/payment-accounts
```

---

## 第五部分：关键业务逻辑验证

### 1. 发货自动扣款

| 验证点 | 预期 |
|--------|------|
| 开单前记录代理余额 | 如 ¥15,000 |
| 开单金额 | 如 ¥5,000 |
| 开单后代理余额 | = ¥10,000（自动扣减） |

### 2. 调货原子操作

| 验证点 | 预期 |
|--------|------|
| 调货前 A 余额 | 如 ¥10,000 |
| 调货前 B 余额 | 如 ¥5,000 |
| A→B 调货金额 | ¥2,000 |
| 调货后 A 余额 | = ¥12,000（+2000 退款） |
| 调货后 B 余额 | = ¥3,000（-2000 扣款） |

### 3. 赠品不计入任务

| 验证点 | 预期 |
|--------|------|
| 代理购买 150 件（含赠品 5 件） | - |
| 年度任务完成量 | = 150 件（不含赠品） |
| 赠品单独统计 | 显示「已获赠品：5 件」 |

### 4. 凭证图片查重

| 验证点 | 预期 |
|--------|------|
| 第一次上传某截图 | 充值成功 |
| 第二次上传同一截图 | 提示「该转账截图已被使用过」 |

---

**验证完成后，请在对应项打 ✓**
