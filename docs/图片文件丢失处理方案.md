# 图片文件丢失处理方案

## 问题描述

数据库中存储了图片路径（如 `/api/uploads/1767549698557-0c62ef97-1809-4425-9a51-48618e8f2cda.jpeg`），但服务器上的实际文件不存在，导致访问时返回 404 错误。

## 原因分析

1. 文件在服务器迁移或部署时丢失
2. 上传目录被清空或路径变更
3. 文件从未成功上传到服务器

## 解决方案

### 方案一：重新上传图片（推荐）

如果还有原始图片文件，可以重新上传：
1. 登录系统
2. 找到需要更新图片的记录（代理商、产品等）
3. 重新上传图片

### 方案二：提供默认占位图片

如果无法找回原始图片，可以：
1. 创建一个默认占位图片
2. 修改代码，当图片不存在时显示占位图片

### 方案三：从备份恢复

如果有服务器备份，可以从备份中恢复 `/var/www/nomur/server/uploads/` 目录。

## 预防措施

1. **定期备份上传目录**：
   ```bash
   # 备份上传目录
   tar -czf /backup/uploads_$(date +%Y%m%d).tar.gz /var/www/nomur/server/uploads/
   ```

2. **配置自动备份**：
   - 使用 cron 定时任务定期备份
   - 或使用云存储（OSS/COS）存储上传文件

3. **监控上传目录**：
   - 定期检查上传目录的文件数量
   - 设置告警机制

## 当前状态

- 上传目录：`/var/www/nomur/server/uploads/`
- 目录状态：空（无文件）
- Nginx 配置：已修复，location 顺序已调整
- 上传功能：正常（已测试）

## 建议操作

1. 检查是否有备份可以恢复
2. 如果没有备份，需要重新上传所有图片
3. 考虑配置自动备份机制

