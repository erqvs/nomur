"use strict";const t=require("../common/vendor.js"),e=(()=>"https://100nomur.net/api")();async function a(a,o={}){const{customHeader:s,...d}=o;return new Promise((o,r)=>{t.index.request({url:`${e}${a}`,...d,header:{...d.header||{},...s||{}},success:t=>{try{if(t.statusCode>=200&&t.statusCode<300){const e=t.data;if(0===e.code)o(e.data);else{const t=e.message||"请求失败";r(new Error(t))}}else{const e=t.data,a=(null==e?void 0:e.message)||`请求失败 (${t.statusCode})`;r(new Error(a))}}catch(e){!(e instanceof Error)||e.message,r(e)}},fail:t=>{const e=(null==t?void 0:t.message)||(null==t?void 0:t.errMsg)||"网络错误";r(new Error(e))}})})}const o={getAll:()=>a("/products"),create:t=>a("/products",{method:"POST",data:t}),update:(t,e)=>a("/products/"+t,{method:"PUT",data:e}),delete:t=>a("/products/"+t,{method:"DELETE"})},s={getAll:()=>a("/agents"),getById:t=>a("/agents/"+t),create:t=>a("/agents",{method:"POST",data:t}),update:(t,e)=>a("/agents/"+t,{method:"PUT",data:e}),updateSort:t=>a("/agents/sort",{method:"PUT",data:{sortList:t}}),getStatistics:t=>a("/agents/"+t+"/statistics"),delete:t=>a("/agents/"+t,{method:"DELETE"})},d={getAll:()=>a("/drivers"),create:t=>a("/drivers",{method:"POST",data:t})},r={getAll:()=>a("/promotions"),create:t=>a("/promotions",{method:"POST",data:t}),update:(t,e)=>a("/promotions/"+t,{method:"PUT",data:e}),delete:t=>a("/promotions/"+t,{method:"DELETE"})},n={getAll:()=>a("/product-groups"),create:t=>a("/product-groups",{method:"POST",data:t}),update:(t,e)=>a("/product-groups/"+t,{method:"PUT",data:e}),delete:t=>a("/product-groups/"+t,{method:"DELETE"})},c={getAll:t=>a("/orders"+(t?`?agentId=${t}`:"")),getById:t=>a("/orders/"+t),create:t=>a("/orders",{method:"POST",data:t}),update:(t,e,o,s)=>a("/orders/"+t,{method:"PUT",data:e,customHeader:{"admin-id":o,"admin-role":s}})},p={getAll:t=>a("/transactions"+(t?`?agentId=${t}`:"")),recharge:t=>a("/transactions/recharge",{method:"POST",data:t}),deduct:t=>a("/transactions/deduct",{method:"POST",data:t}),transfer:t=>a("/transactions/transfer",{method:"POST",data:t}),update:(t,e,o,s)=>a("/transactions/"+t,{method:"PUT",data:e,customHeader:{"admin-id":o,"admin-role":s}})},i={getAll:()=>a("/payment-accounts"),create:t=>a("/payment-accounts",{method:"POST",data:t}),getTransactions:t=>a("/payment-accounts/"+t+"/transactions"),getBalanceDetails:t=>a("/payment-accounts/"+t+"/balance-details"),deduct:(t,e)=>a("/payment-accounts/"+t+"/deduct",{method:"POST",data:e}),update:(t,e)=>a("/payment-accounts/"+t,{method:"PUT",data:e}),updateBalance:(t,e)=>a("/payment-accounts/"+t+"/balance",{method:"PUT",data:{balance:e}}),delete:t=>a("/payment-accounts/"+t,{method:"DELETE"})},l={get:()=>a("/statistics")},u={create:(t,e)=>a("/agents/"+t+"/supplement-sales",{method:"POST",data:e}),getByAgent:t=>a("/agents/"+t+"/supplement-sales"),delete:t=>a("/supplement-sales/"+t,{method:"DELETE"})},m={uploadSingle:a=>new Promise((o,s)=>{t.index.uploadFile({url:`${e}/upload`,filePath:a,name:"file",success:e=>{try{const a=JSON.parse(e.data);0===a.code?o(a.data):(t.index.showToast({title:a.message,icon:"none"}),s(new Error(a.message)))}catch(a){s(a)}},fail:e=>{t.index.showToast({title:"上传失败",icon:"none"}),s(e)}})}),uploadMultiple:t=>Promise.all(t.map(t=>m.uploadSingle(t)))};exports.agentApi=s,exports.driverApi=d,exports.orderApi=c,exports.paymentAccountApi=i,exports.productApi=o,exports.productGroupApi=n,exports.promotionApi=r,exports.statisticsApi=l,exports.supplementApi=u,exports.transactionApi=p,exports.uploadApi=m;
