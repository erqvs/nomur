"use strict";const e=require("../../../common/vendor.js"),t=require("../../../common/assets.js"),a=require("../../../stores/app.js");Math||n();const n=()=>"../../../components/CustomTabBar/index.js",r=e.defineComponent({__name:"index",setup(n){const r=a.useAppStore(),o=[{label:"全部",value:"all"},{label:"充值",value:"recharge"},{label:"扣款",value:"deduct"},{label:"调货",value:"transfer"}],s=e.ref("all"),i=e.computed(()=>"all"===s.value?r.transactions:"transfer"===s.value?r.transactions.filter(e=>"transfer_in"===e.reason||"transfer_out"===e.reason):r.transactions.filter(e=>e.type===s.value)),c=()=>{try{const t=getCurrentPages();if(t.length>0){const a="/"+t[t.length-1].route;e.index.$emit("update-tabbar-path",a)}}catch(t){console.error("更新 tabbar 路径失败:",t)}};e.onMounted(async()=>{c(),await r.loadTransactions()}),e.onShow(async()=>{c(),await r.loadTransactions()});const u=e=>{const t=new Date(e);return`${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},l=e=>({gift:"赠送",payment:"充值到账",shipping:"发货扣款",fine:"罚款",transfer_in:"调货收入",transfer_out:"调货支出",freight:"运费",marketing:"营销退款"}[e]||e),p=e.ref(!1),g=e.ref(!1),d=e.ref(!1);return(a,n)=>e.e({a:t._imports_0$3,b:e.o(e=>p.value=!0),c:t._imports_1$4,d:e.o(e=>g.value=!0),e:t._imports_2$1,f:e.o(e=>d.value=!0),g:e.f(o,(t,a,n)=>({a:e.t(t.label),b:t.value,c:s.value===t.value?1:"",d:e.o(e=>s.value=t.value,t.value)})),h:e.f(i.value,(a,n,r)=>{return e.e({a:(o=a.reason,{gift:"/static/icons/gift.svg",payment:"/static/icons/credit-card.svg",shipping:"/static/icons/package.svg",fine:"/static/icons/alert-circle.svg",transfer_in:"/static/icons/arrow-down.svg",transfer_out:"/static/icons/arrow-up.svg",freight:"/static/icons/truck.svg",marketing:"/static/icons/trending-up.svg"}[o]||"/static/icons/file-text.svg"),b:e.t(a.agentName),c:e.o(t=>{return n=a.agentId,void e.index.navigateTo({url:`/pages/admin/agents/detail?id=${n}`});var n},a.id),d:e.t(l(a.reason)),e:"recharge"===a.type&&"payment"===a.reason&&a.paymentAccountName},"recharge"===a.type&&"payment"===a.reason&&a.paymentAccountName?{f:e.t(a.paymentAccountName),g:e.o(t=>(a.paymentAccountId,a.paymentAccountName,void e.index.navigateTo({url:"/pages/admin/payees/index"})),a.id)}:{},{h:"shipping"===a.reason&&a.orderItems&&a.orderItems.length>0},"shipping"===a.reason&&a.orderItems&&a.orderItems.length>0?{i:e.f(a.orderItems,(t,a,n)=>({a:e.t(t.productName),b:e.t(t.quantity),c:a}))}:{},{j:e.t(a.amount>0?"+":""),k:e.t(Math.abs(a.amount).toLocaleString()),l:a.amount>0?1:"",m:a.amount<0?1:"",n:a.proof},a.proof?{o:a.proof,p:t._imports_3,q:e.o(t=>{return n=a.proof,void e.index.previewImage({urls:[n]});var n},a.id)}:{},{r:e.t(u(a.createdAt)),s:e.o(t=>(t=>{e.index.navigateTo({url:`/pages/super/transactions/edit?id=${t.id}`})})(a),a.id),t:a.id});var o}),i:0===i.value.length},0===i.value.length?{j:t._imports_0$5}:{})}}),o=e._export_sfc(r,[["__scopeId","data-v-36285671"]]);wx.createPage(o);
