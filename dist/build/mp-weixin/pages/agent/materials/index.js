"use strict";const e=require("../../../common/vendor.js"),a=require("../../../common/assets.js"),i=require("../../../stores/app.js"),t=e.defineComponent({__name:"index",setup(t){var n;const l=i.useAppStore(),s=e.computed(()=>l.products),o=e.ref((null==(n=s.value[0])?void 0:n.id)||""),d=e.computed(()=>s.value.find(e=>e.id===o.value)),r=a=>{e.index.showLoading({title:"保存中..."}),e.index.downloadFile({url:a,success:a=>{e.index.saveImageToPhotosAlbum({filePath:a.tempFilePath,success:()=>{e.index.hideLoading(),e.index.showToast({title:"保存成功",icon:"success"})},fail:()=>{e.index.hideLoading(),e.index.showToast({title:"保存失败",icon:"none"})}})},fail:()=>{e.index.hideLoading(),e.index.showToast({title:"下载失败",icon:"none"})}})},u=async()=>{if(!d.value)return;const a=d.value.materials;if(0===a.length)return;e.index.showLoading({title:`保存中 0/${a.length}`});let i=0;for(let t=0;t<a.length;t++)try{const n=await new Promise((i,n)=>{e.index.downloadFile({url:a[t],success:i,fail:n})});await new Promise((a,i)=>{e.index.saveImageToPhotosAlbum({filePath:n.tempFilePath,success:()=>a(),fail:()=>i()})}),i++,e.index.showLoading({title:`保存中 ${i}/${a.length}`})}catch{}e.index.hideLoading(),e.index.showToast({title:`成功保存 ${i} 张`,icon:i===a.length?"success":"none"})};return(i,t)=>e.e({a:e.f(s.value,(a,i,t)=>({a:a.image,b:e.t(a.name.replace(/产品-/,"")),c:a.id,d:o.value===a.id?1:"",e:e.o(e=>o.value=a.id,a.id)})),b:d.value},d.value?e.e({c:e.t(d.value.name),d:e.t(d.value.materials.length),e:d.value.materials.length>0},d.value.materials.length>0?{f:e.f(d.value.materials,(a,i,t)=>({a:a,b:e.o(i=>{return t=a,n=d.value.materials,void e.index.previewImage({current:t,urls:n});var t,n},i),c:e.o(e=>r(a),i),d:e.o(e=>r(a),i),e:i})),g:a._imports_0$8}:{},{h:d.value.netdiskUrl},d.value.netdiskUrl?{i:a._imports_1$8,j:a._imports_2,k:e.o(a=>{return i=d.value.netdiskUrl,void e.index.setClipboardData({data:i,success:()=>{e.index.showModal({title:"链接已复制",content:"请在浏览器中打开链接下载",showCancel:!1})}});var i})}:{l:a._imports_3$1}):{},{m:d.value&&d.value.materials.length>0},d.value&&d.value.materials.length>0?{n:e.o(u)}:{})}}),n=e._export_sfc(t,[["__scopeId","data-v-42f7bb8e"]]);wx.createPage(n);
