---
alwaysApply: true
---

# Nomur é¡¹ç›®æœåŠ¡å™¨é…ç½®ä¿¡æ¯

## æœåŠ¡å™¨åŸºç¡€é…ç½®

### ç³»ç»Ÿä¿¡æ¯
| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| æ“ä½œç³»ç»Ÿ | Ubuntu 22.04.5 LTS (Jammy Jellyfish) |
| å†…æ ¸ç‰ˆæœ¬ | Linux 5.15.0-164-generic |
| æ¶æ„ | x86_64 |
| ä¸»æœºå | iZ2vce5hphoo9xqk6sp7b8Z |
| Shell | /bin/bash |

### ç¡¬ä»¶é…ç½®
| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| CPU | AMD EPYC (2æ ¸å¿ƒï¼Œæ¯æ ¸å¿ƒ2çº¿ç¨‹) |
| ç‰©ç†å†…å­˜ | 3.4GB |
| äº¤æ¢åˆ†åŒº | 2GB (ä½äº /swapfileï¼Œå·²æ°¸ä¹…å¯ç”¨) |
| æ€»å¯ç”¨å†…å­˜ | 5.4GB (3.4GB + 2GB) |
| ç£ç›˜ | /dev/nvme0n1p3 (59GB æ€»å®¹é‡ï¼Œ53GB å¯ç”¨) |
| ç£ç›˜ä½¿ç”¨ç‡ | 6% |

### å·¥ä½œç›®å½•
- **é¡¹ç›®æ ¹ç›®å½•**: `/var/www/nomur`
- **æœåŠ¡å™¨å·¥ä½œç©ºé—´**: `/var/www`

### åŸŸåé…ç½®
- **ä¸»åŸŸå**: `100nomur.net`
- **WWW å­åŸŸå**: `www.100nomur.net`
- **DNS è§£æ**: å·²é…ç½® @ å’Œ www è§£æ

## å·²å®‰è£…è½¯ä»¶ç¯å¢ƒ

| è½¯ä»¶/æœåŠ¡ | ç‰ˆæœ¬ | å®‰è£…ä½ç½® | çŠ¶æ€ |
|-----------|------|----------|------|
| Git | 2.34.1 | ç³»ç»ŸåŒ… | âœ… å¯ç”¨ |
| Node.js | 20.19.6 | NodeSource | âœ… å¯ç”¨ |
| npm | 10.8.2 | éš Node.js | âœ… å¯ç”¨ |
| PM2 | 6.0.14 | å…¨å±€ npm | âœ… å¯ç”¨ |
| Nginx | 1.18.0 | ç³»ç»ŸåŒ… | âœ… è¿è¡Œä¸­ |
| MySQL Server | 8.0.44 | ç³»ç»ŸåŒ… | âœ… è¿è¡Œä¸­ |
| curl | 7.81.0 | ç³»ç»ŸåŒ… | âœ… å¯ç”¨ |
| wget | 1.21.2 | ç³»ç»ŸåŒ… | âœ… å¯ç”¨ |
| vim | 8.2.3995 | ç³»ç»ŸåŒ… | âœ… å¯ç”¨ |
| nano | 6.2 | ç³»ç»ŸåŒ… | âœ… å¯ç”¨ |
| build-essential | 12.9 | ç³»ç»ŸåŒ… | âœ… å¯ç”¨ |
| ufw | 0.36.1 | ç³»ç»ŸåŒ… | âœ… å¯ç”¨ |

## é¡¹ç›®ç»“æ„

### ç›®å½•è¯´æ˜
```
/var/www/nomur/
â”œâ”€â”€ src/              # å‰ç«¯æºç  (uni-app + Vue3 + TypeScript)
â”œâ”€â”€ server/           # åç«¯ API æœåŠ¡ (Node.js + Express)
â”œâ”€â”€ docs/             # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ tests/            # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ nomur_database.sql # æ•°æ®åº“åˆå§‹åŒ–æ–‡ä»¶
â””â”€â”€ package.json      # å‰ç«¯ä¾èµ–é…ç½®
```

### åç«¯æœåŠ¡é…ç½®
| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| æœåŠ¡ç›®å½• | `/var/www/nomur/server` |
| å…¥å£æ–‡ä»¶ | `server/index.js` |
| è¿›ç¨‹ç®¡ç† | PM2 (å·²é…ç½®ï¼Œå·²è®¾ç½®å¼€æœºè‡ªå¯) |
| ç›‘å¬ç«¯å£ | 3001 (é»˜è®¤) |
| æ•°æ®åº“ | MySQL 8.0.44 (å·²é…ç½®) |
| æ•°æ®åº“å | nomur |
| æ•°æ®åº“ä¸»æœº | localhost |
| æ•°æ®åº“ç”¨æˆ· | root |
| å­—ç¬¦é›† | utf8mb4 |

### å‰ç«¯æœåŠ¡é…ç½®
| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| å‰ç«¯ç±»å‹ | uni-app (Vue3 + TypeScript) |
| H5 æ„å»ºç›®å½• | `/var/www/nomur/dist/build/h5` |
| H5 è®¿é—®åœ°å€ | https://100nomur.net |
| å°ç¨‹åºæ„å»ºç›®å½• | `/var/www/nomur/dist/build/mp-weixin` |
| H5 æ„å»ºå‘½ä»¤ | `npm run build:h5` |
| å°ç¨‹åºæ„å»ºå‘½ä»¤ | `npm run build:mp-weixin` |
| H5 æ„å»ºçŠ¶æ€ | âœ… å·²æ„å»ºå¹¶éƒ¨ç½² |
| å°ç¨‹åºæ„å»ºçŠ¶æ€ | ğŸ“ éœ€è¦æ„å»ºåä¸Šä¼ åˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…· |

### ç½‘ç»œé…ç½®
| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| ä¸»åŸŸå | 100nomur.net |
| WWW å­åŸŸå | www.100nomur.net |
| DNS è§£æ | å·²é…ç½® @ å’Œ www è§£æ |
| Nginx é…ç½® | /etc/nginx/sites-available/nomur |
| åç«¯æœåŠ¡ç«¯å£ | 3001 |
| é˜²ç«å¢™çŠ¶æ€ | å·²å¯ç”¨ï¼Œå·²å¼€æ”¾ 80/443 ç«¯å£ |
| SSL è¯ä¹¦ | Let's Encrypt (å·²é…ç½®) |
| è¯ä¹¦é¢å‘æœºæ„ | Let's Encrypt |
| è¯ä¹¦ç”³è¯·å·¥å…· | acme.sh (Gitee é•œåƒå®‰è£…) |
| è¯ä¹¦è·¯å¾„ | /etc/nginx/ssl/100nomur.net.pem |
| è¯ä¹¦å¯†é’¥ | /etc/nginx/ssl/100nomur.net.key |
| è¯ä¹¦æœ‰æ•ˆæœŸ | 2026-01-06 è‡³ 2026-03-07 (è‡ªåŠ¨ç»­æœŸ) |
| HTTPS çŠ¶æ€ | å·²å¯ç”¨ï¼ŒHTTP è‡ªåŠ¨é‡å®šå‘åˆ° HTTPS |
| npm é•œåƒæº | å·²é…ç½®æ·˜å®é•œåƒ (registry.npmmirror.com) |
| acme.sh è·¯å¾„ | ~/.acme.sh |

## æ³¨æ„äº‹é¡¹

- âš ï¸ **å†…å­˜èµ„æºæœ‰é™**ï¼šæœåŠ¡å™¨ä»… 3.4GB ç‰©ç†å†…å­˜ï¼Œå·²é…ç½® 2GB äº¤æ¢ç©ºé—´
- âš ï¸ **å¼€å‘æ—¶æ³¨æ„**ï¼šé¿å…åŒæ—¶è¿è¡Œå¤šä¸ªå†…å­˜å¯†é›†å‹ä»»åŠ¡
- âœ… **äº¤æ¢ç©ºé—´å·²é…ç½®**ï¼šå·²æ·»åŠ åˆ° `/etc/fstab`ï¼Œé‡å¯åè‡ªåŠ¨å¯ç”¨
- âœ… **Nginx å·²é…ç½®**ï¼šå·²è®¾ç½®ä¸ºå¼€æœºè‡ªå¯
- âœ… **MySQL å·²é…ç½®**ï¼šå·²å®‰è£…å¹¶è¿è¡Œï¼Œæ•°æ®åº“å·²å¯¼å…¥ï¼Œå·²è®¾ç½®ä¸ºå¼€æœºè‡ªå¯
- âœ… **PM2 å·²é…ç½®**ï¼šå·²è®¾ç½®å¼€æœºè‡ªå¯ï¼Œåç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ
- âœ… **SSL è¯ä¹¦å·²é…ç½®**ï¼šå·²ä½¿ç”¨ acme.sh ç”³è¯· Let's Encrypt è¯ä¹¦ï¼ŒHTTPS å·²å¯ç”¨
- âœ… **npm é•œåƒå·²é…ç½®**ï¼šå·²é…ç½®æ·˜å®é•œåƒæºï¼ŒåŠ é€Ÿä¾èµ–å®‰è£…
- âœ… **å‰ç«¯å·²æ„å»º**ï¼šH5 ç‰ˆæœ¬å·²æ„å»ºå¹¶éƒ¨ç½²ï¼Œå¯é€šè¿‡ https://100nomur.net è®¿é—®
- âœ… **æ•°æ®åº“è¿æ¥å·²é…ç½®**ï¼šå·²ä¿®æ”¹ä¸ºä½¿ç”¨æœ¬æœº MySQL (localhost)
- âš ï¸ **ä»£ç æ”¹åŠ¨åéœ€é‡æ–°æ„å»º**ï¼š
  - ä¿®æ”¹å‰ç«¯ä»£ç åï¼ŒH5 ç‰ˆæœ¬éœ€è¿è¡Œ `npm run build:h5` æ‰èƒ½ç”Ÿæ•ˆ
  - å°ç¨‹åºç‰ˆæœ¬éœ€è¿è¡Œ `npm run build:mp-weixin`ï¼Œç„¶åä¸Šä¼ åˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·
- ğŸ“ **å°ç¨‹åºå‘å¸ƒæµç¨‹**ï¼šæ„å»º â†’ ä¸Šä¼ åˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…· â†’ æäº¤å®¡æ ¸ â†’ å‘å¸ƒ

## å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†
```bash
# Nginx
sudo systemctl status nginx
sudo systemctl restart nginx
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl reload nginx  # é‡æ–°åŠ è½½é…ç½®
sudo tail -f /var/log/nginx/error.log  # æŸ¥çœ‹é”™è¯¯æ—¥å¿—

# PM2
pm2 start server/index.js --name nomur-api
pm2 list
pm2 logs nomur-api
pm2 restart nomur-api
pm2 save  # ä¿å­˜è¿›ç¨‹åˆ—è¡¨
pm2 startup  # è®¾ç½®å¼€æœºè‡ªå¯

# MySQL
sudo systemctl status mysql
sudo systemctl restart mysql
sudo mysql -u root -p  # ç™»å½• MySQL
sudo mysql nomur < nomur_database.sql  # å¯¼å…¥æ•°æ®åº“
sudo mysql -e "SHOW DATABASES;"  # æŸ¥çœ‹æ•°æ®åº“åˆ—è¡¨
sudo mysql -e "USE nomur; SHOW TABLES;"  # æŸ¥çœ‹è¡¨åˆ—è¡¨
```

### é¡¹ç›®æ„å»º
```bash
# å‰ç«¯æ„å»º
cd /var/www/nomur

# æ„å»º H5 ç‰ˆæœ¬ï¼ˆç”¨äº Web è®¿é—®ï¼‰
npm run build:h5         # æ„å»ºåˆ° dist/build/h5

# æ„å»ºå¾®ä¿¡å°ç¨‹åºç‰ˆæœ¬ï¼ˆç”¨äºå°ç¨‹åºå‘å¸ƒï¼‰
npm run build:mp-weixin   # æ„å»ºåˆ° dist/build/mp-weixin

# æ„å»ºå®Œæˆåï¼š
# - H5 ç‰ˆæœ¬ä¼šè‡ªåŠ¨éƒ¨ç½²åˆ° https://100nomur.net
# - å°ç¨‹åºç‰ˆæœ¬éœ€è¦ä¸Šä¼ åˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·è¿›è¡Œå‘å¸ƒ

# åç«¯å¯åŠ¨
cd /var/www/nomur/server
npm install
npm start  # æˆ–ä½¿ç”¨ PM2: pm2 start index.js

# å‰ç«¯ä¾èµ–å®‰è£…ï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
cd /var/www/nomur
npm install
```

### SSL è¯ä¹¦ç®¡ç†
```bash
# æŸ¥çœ‹è¯ä¹¦åˆ—è¡¨
~/.acme.sh/acme.sh --list

# æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯
~/.acme.sh/acme.sh --info -d 100nomur.net

# æ‰‹åŠ¨ç»­æœŸï¼ˆé€šå¸¸è‡ªåŠ¨ç»­æœŸï¼‰
~/.acme.sh/acme.sh --renew -d 100nomur.net

# é‡æ–°å®‰è£…è¯ä¹¦åˆ° Nginx
~/.acme.sh/acme.sh --install-cert -d 100nomur.net \
  --key-file /etc/nginx/ssl/100nomur.net.key \
  --fullchain-file /etc/nginx/ssl/100nomur.net.pem \
  --reloadcmd "systemctl reload nginx"
```

### ç³»ç»Ÿç›‘æ§
```bash
# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -h

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h

# æŸ¥çœ‹è¿›ç¨‹
top
# æˆ–
htop  # å¦‚æœå·²å®‰è£…
```
